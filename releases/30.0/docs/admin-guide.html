<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.20">
<meta name="author" content="The INCEpTION Team">
<title>INCEpTION Administrator Guide</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<!-- Generate a nice TOC -->
<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.1.0.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js"></script>

<!-- We do not need the tocify CSS because the asciidoc CSS already provides most of what we need -->

<style>
  .tocify-header {
    font-style: italic;
  }

  .tocify-subheader {
    font-style: normal;
    font-size: 90%;
  }

  .tocify ul {
    margin: 0;
  }

  .tocify-focus {
    color: #7a2518;
    background-color: rgba(0, 0, 0, 0.1);
  }

  .tocify-focus > a {
    color: #7a2518;
  }
</style>

<script>
    $(function () {
        // Add a new container for the tocify toc into the existing toc so we can re-use its
        // styling
        $("#toc").append("<div id='generated-toc'></div>");
        $("#generated-toc").tocify({
            extendPage: true,
            context: "#content",
            highlightOnScroll: true,
            hideEffect: "slideUp",
            // Use the IDs that asciidoc already provides so that TOC links and intra-document
            // links are the same. Anything else might confuse users when they create bookmarks.
            hashGenerator: function(text, element) {
                return $(element).attr("id");
            },
            // Smooth scrolling doesn't work properly if we use the asciidoc IDs
            smoothScroll: false,
            // Set to 'none' to use the tocify classes
            theme: "none",
            // Handle book (may contain h1) and article (only h2 deeper)
            selectors: $( "#content" ).has( "h1" ).length > 0 ? "h1,h2,h3,h4,h5" : "h2,h3,h4,h5",
            ignoreSelector: ".discrete"
        });

        // Switch between static asciidoc toc and dynamic tocify toc based on browser size
        // This is set to match the media selectors in the asciidoc CSS
        // Without this, we keep the dynamic toc even if it is moved from the side to preamble
        // position which will cause odd scrolling behavior
        var handleTocOnResize = function() {
            if ($(document).width() < 768) {
                $("#generated-toc").hide();
                $(".sectlevel0").show();
                $(".sectlevel1").show();
            }
            else {
                $("#generated-toc").show();
                $(".sectlevel0").hide();
                $(".sectlevel1").hide();
            }
        }

        $(window).resize(handleTocOnResize);
        handleTocOnResize();
    });
</script>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>INCEpTION Administrator Guide</h1>
<div class="details">
<span id="author" class="author">The INCEpTION Team</span><br>
<span id="revnumber">version 30.0</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#sect_installation">Installation</a>
<ul class="sectlevel1">
<li><a href="#_system_requirements">System Requirements</a></li>
<li><a href="#_install_java">Install Java</a></li>
<li><a href="#sect_home_folder">Application home folder</a></li>
<li><a href="#sect_database">Database</a>
<ul class="sectlevel2">
<li><a href="#_mariadb">MariaDB</a>
<ul class="sectlevel3">
<li><a href="#_prepare_database">Prepare database</a></li>
<li><a href="#_configuration_options">Configuration options</a></li>
<li><a href="#_using_mysql_instead_of_mariadb">Using MySQL instead of MariaDB</a></li>
</ul>
</li>
<li><a href="#_hsqldb_embedded">HSQLDB (embedded)</a></li>
</ul>
</li>
<li><a href="#_running_via_embedded_tomcat_jar">Running via embedded Tomcat (JAR)</a>
<ul class="sectlevel2">
<li><a href="#_installing_as_a_service">Installing as a service</a></li>
<li><a href="#_loading_extra_java_libraries">Loading extra Java libraries</a></li>
</ul>
</li>
<li><a href="#sect_reverse_proxy">Running the behind a reverse proxy (JAR)</a>
<ul class="sectlevel2">
<li><a href="#_csrf_protection">CSRF protection</a></li>
<li><a href="#_apache_httpd_as_reverse_proxy">Apache HTTPD as reverse proxy</a>
<ul class="sectlevel3">
<li><a href="#_obtaining_a_lets_encrypt_certificate">Obtaining a Let&#8217;s Encrypt certificate</a></li>
</ul>
</li>
<li><a href="#_nginx_as_reverse_proxy">NGINX as reverse proxy</a>
<ul class="sectlevel3">
<li><a href="#_obtaining_a_lets_encrypt_certificate_2">Obtaining a Let&#8217;s Encrypt certificate</a></li>
<li><a href="#_putting_it_all_together">Putting it all together</a></li>
</ul>
</li>
<li><a href="#_caddy_as_a_reverse_proxy">Caddy as a reverse proxy</a></li>
</ul>
</li>
<li><a href="#sect_docker">Running via Docker</a>
<ul class="sectlevel2">
<li><a href="#_quick_start">Quick start</a></li>
<li><a href="#_storing_data_on_the_host">Storing data on the host</a></li>
<li><a href="#_settings_file">Settings file</a></li>
<li><a href="#_connecting_to_a_dedicated_database">Connecting to a dedicated database</a></li>
<li><a href="#_memory_and_other_java_options">Memory and other Java options</a></li>
</ul>
</li>
<li><a href="#_delete_annotation_backups_older_than_30_days_60_60_24_30_30_days">Delete annotation backups older than 30 days (60 * 60 * 24 * 30 = 30 days)</a></li>
<li><a href="#_at_least_5_minutes_must_pass_between_two_annotation_backups_60_5_5_minutes">At least 5 minutes must pass between two annotation backups (60 * 5 = 5 minutes)</a></li>
<li><a href="#_keep_at_most_10_backups_for_each_annotation_backup">Keep at most 10 backups for each annotation backup</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This guide covers handling INCEpTION from an administrator&#8217;s perspective.</p>
</div>
</div>
</div>
<h1 id="sect_installation" class="sect0"><a class="anchor" href="#sect_installation"></a>Installation</h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>You can run INCEpTION on any major platform supporting Java, i.e. Linux, macOS or Windows.
However, we do not provide explicit support for setting up a production-ready instance of each of these
platforms.</p>
</div>
<div class="paragraph">
<p>This guide assumes Debian 9.1 (Stretch). It may also work on Ubuntu with some modifications, but we
do not test this. Instructions for other Linux distributions and other platforms (i.e. macOS and
Windows) likely deviate significantly.</p>
</div>
<div class="paragraph">
<p>It is further assumed that the user <strong>www-data</strong> already exists on the system and that it shall be used to run the application.</p>
</div>
<div class="paragraph">
<p>All commands assume that you are logged in as the <strong>root</strong> user.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you cannot log in as root but have to use <code>sudo</code> to become root, then the recommended way
      to do that is using the command <code>sudo su -</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_system_requirements"><a class="anchor" href="#_system_requirements"></a>System Requirements</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Requirements for users</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Browser</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Chrome or Safari</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Requirements to run the standalone version</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operating System</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Linux (64bit), macOS (64bit), Windows (64bit)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java Runtime Environment</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">version 11 or higher</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Requirements run the server version</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operating System</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Linux (64bit), macOS (64bit), Windows (64bit)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java Runtime Environment</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">version 11 or higher</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MariaDB Server (or compatible)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">version 10.5 or higher</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. Requirements for a Docker-based deployment</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Docker</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">version 24 or higher (arm64 or amd64)</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<a href="https://mariadb.org">MariaDB</a> is an open source drop-in replacement for <a href="https://www.mysql.com">MySQL</a>. So generally, you can also use MySQL instead of MariaDB. Also, as far as we know, we do not use any fancy features of MariaDB 10.5 and did in fact until recently always use MySQL 5. So you can probably also use an older version of MariaDB or MySQL&#8230;&#8203; but why should you? Think of all the unfixed bugs and consider also upgrading your database if you do a fresh installation of INCEpTION - or use <a href="admin_guide.html#sect_docker">Docker</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_install_java"><a class="anchor" href="#_install_java"></a>Install Java</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you aim for a Docker-based deployment, it is useful for you to read the following sections to better understand
      how the overall setup works. However, you will not have to install Java. If you use Docker Compose, you may also not have
      to install a database. Refer to the <a href="#sect_docker">Running via Docker</a> section instead.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can install a Java 11 JDK using the following commands.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ apt-get update
$ apt-get install openjdk-11-jdk</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sect_home_folder"><a class="anchor" href="#sect_home_folder"></a>Application home folder</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The INCEpTION home folder is the place where INCEpTION&#8217;s configuration file <code>settings.properties</code>
resides and where INCEpTION stores its data. By default, this is a (hidden) folder called <code>.inception</code> in
the home directory of the user running INCEpTION. However, you can override the location of the
home folder using the system property <code>inception.home</code>.</p>
</div>
<div class="listingblock">
<div class="title">Passing a custom home folder location to INCEpTION when starting from the command line</div>
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ java -Dinception.home="/srv/inception" -jar inception-app-webapp-30.0-standalone.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to use a <code>settings.properties</code> file, you need to place it into the INCEpTION home folder yourself.
While the home folder is automatically created if it does not exist, the <code>settings.properties</code> is not
automatically created by the application.
Mind that if you are using a dedicated database server
(recommended), then INCEpTION also stores some data in the dedicated database. This is important when
you plan to perform a backup, as both the home folder and the database content need to be
included in the backup.</p>
</div>
<div class="paragraph">
<p>Now, let&#8217;s go through the steps of setting up a home folder for INCEpTION and creating a
configuration file instructing INCEpTION to access a dedicated <a href="#sect_database">database</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create INCEpTION home folder. This is the directory where INCEpTION settings files and projects (documents, annotations, etc.) are stored</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ mkdir /srv/inception</code></pre>
</div>
</div>
</li>
<li>
<p>Create and edit <code>/srv/inception/settings.properties</code> to define the database connection as well as internal backup properties:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">database.url=jdbc:mariadb://localhost:3306/inception?useSSL=false&amp;serverTimezone=UTC&amp;useUnicode=yes&amp;characterEncoding=UTF-8
database.username=inception
database.password=t0t4llYSecreT</code></pre>
</div>
</div>
</li>
<li>
<p>Fix permissions in INCEpTION home folder</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ chown -R www-data:www-data /srv/inception</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sect_database"><a class="anchor" href="#sect_database"></a>Database</h2>
<div class="sectionbody">
<div class="paragraph">
<p>INCEpTION uses a SQL database to store project and user data.</p>
</div>
<div class="paragraph">
<p>INCEpTION uses by default an embedded HSQLDB database. However, we recommend using the embedded
database only for testing purposes. For production use, we recommend using a MariaDB server (or compatible). The reason
for this is, that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>some users have reported that HSQLDB databases may become corrupt when the computer crashes
(note that this could probably also happen with MariaDB, but we did so far not have any reports
about this);</p>
</li>
<li>
<p>most INCEpTION developers use MariaDB (or compatible) when running INCEpTION on their
servers;</p>
</li>
<li>
<p>in the past, we had cases where we described in-place upgrade procedures that required performing
SQL commands to change the data model as part of the upgrade. We promise to try avoiding this in
the future. However, in case we offer advice on fixing anything directly in the database, this
advice will refer to a MariaDB database.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We try to keep the data model simple, so there should be no significant requirements to the database
being used. Theoretically, it should be possible to use any JDBC-compatible database after adding a
corresponding driver to the classpath and configuring INCEpTION to use the driver in the
<code>settings.properties</code> file.</p>
</div>
<div class="sect2">
<h3 id="_mariadb"><a class="anchor" href="#_mariadb"></a>MariaDB</h3>
<div class="paragraph">
<p>For production use of INCEpTION, it is highly recommended to use a MariaDB database. In this
section, we briefly describe how to install a MariaDB server and how to prepare it for use with
the application.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
MariaDB is an open-source drop-in replacement for MySQL. As a matter of fact, most of the commands and configuration files still use <code>mysql</code> in many places - so do not be confused if you read a lot about MySQL below despite working with MariaDB.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_prepare_database"><a class="anchor" href="#_prepare_database"></a>Prepare database</h4>
<div class="ulist">
<ul>
<li>
<p>Install MariaDB</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ apt-get install mariadb-server</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div id="character-set-config" class="ulist">
<ul>
<li>
<p>When first setting up your database make sure your MariaDB server is configured for 4 Byte UTF-8 (<code>utf8mb4</code>, <code>utf8mb4_bin</code>) to ensure that all unicode characters can be represented (e.g. emojis).</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<strong>Upgrading an existing database installation to 4 Byte UTF-8:</strong> Changing the character-set and collation later can lead to serious trouble, so make sure you have a backup of your database. In that case, you might also need to perform some additional migration steps. We do not provide a database migration guide here, but if you search e.g. for <code>mariadb convert utf8 to utf8mb4</code> (or <code>mysql</code> for that matter), you should find several.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<strong><code>utf8mb4_bin</code> vs. <code>utf8mb4_unicode_ci</code>:</strong> If you search for UTF-8 support in MariaDB, you will generally find the recommendation to use <code>utf8mb4_unicode_ci</code> as the collation. This, however, is a <strong>case-insensitive</strong> collation. INCEpTION is usually <strong>case-sensitive</strong>. If you used a case-insensitive collation in the database, you could not create two projects, one being called <code>MY PROEJCT</code> and the other being called <code>my project</code>, but instead of a nice error from INCEpTION, you would get an ugly error from the database. That is why we recommend using the case-sensitive <code>utf8mb4_bin</code> for the database.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Check that <code>character-set-server</code>, <code>default-character-set</code> are set to <code>utf8mb4</code> and <code>collation-server</code> is set to <code>utf8mb4_unicode_ci</code> by logging into MariaDB with</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ mysql -u root -p</code></pre>
</div>
</div>
<div class="paragraph">
<p>and running</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-mysql" data-lang="mysql">mysql&gt; SHOW VARIABLES WHERE Variable_name LIKE 'character\_set\_%' OR Variable_name LIKE 'collation%';</code></pre>
</div>
</div>
<div class="paragraph">
<p>If this is not the case add the following lines to your MariaDB config file (most likely <code>/etc/mysql/my.cnf</code> or in <code>/etc/mysql/mariadb.conf.d</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">[client]
default-character-set = utf8mb4

[mysql]
default-character-set = utf8mb4

[mysqld]
character-set-client-handshake = FALSE
character-set-server = utf8mb4
collation-server = utf8mb4_bin
innodb_large_prefix=true
innodb_file_format=barracuda
innodb_file_per_table=1
innodb_strict_mode=1
innodb_default_row_format='dynamic'</code></pre>
</div>
</div>
</li>
<li>
<p>now set up the <code>inception</code> database. First login to MariaDB</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ mysql -u root -p</code></pre>
</div>
</div>
</li>
<li>
<p>create a database</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-mysql" data-lang="mysql">mysql&gt; CREATE DATABASE inception DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_bin;</code></pre>
</div>
</div>
</li>
<li>
<p>create a database user called <code>inception</code> with the password <code>t0t4llYSecreT</code> which is later used by the application to access the database (instructions for the <code>settings.properties</code> file in the <a href="#sect_home_folder">Home Folder</a> section).</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-mysql" data-lang="mysql">mysql&gt; CREATE USER 'inception'@'localhost' IDENTIFIED BY 't0t4llYSecreT';
mysql&gt; GRANT ALL PRIVILEGES ON inception.* TO 'inception'@'localhost';
mysql&gt; FLUSH PRIVILEGES;</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
For production use, make sure you choose a different, secret, and secure password.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_configuration_options"><a class="anchor" href="#_configuration_options"></a>Configuration options</h4>
<div class="paragraph">
<p>This section explains some settings that can be added to the <code>database.url</code> in the
<code>settings.properties</code> file when using MariaDB. Settings are separated from the host name and database name with a <code>?</code> character and multiple settings are separated using the <code>&amp;</code> character, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>database.url=jdbc:mariadb://localhost:3306/inception?useSSL=false&amp;serverTimezone=UTC&amp;useUnicode=true&amp;characterEncoding=UTF-8</pre>
</div>
</div>
<div class="paragraph">
<p>To suppress the warning about non-SSL database connections with recent MySQL databases, append the
following setting to the <code>database.url</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>useSSL=false</pre>
</div>
</div>
<div class="paragraph">
<p>You might also need to add the following if the respective connection error occurs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>allowPublicKeyRetrieval=true</pre>
</div>
</div>
<div class="paragraph">
<p>Recent MySQL drivers may refuse to work unless a database server timezone has been specified. The
easiest way to do this is to add the following setting to the <code>database.url</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>serverTimezone=UTC</pre>
</div>
</div>
<div class="paragraph">
<p>If you plan to use 4 Byte UTF-8 encoding for project name and tagset/tag name, make sure both of the following settings for MySQL database are configured:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>in the <code>settings.properties</code> file, make sure that <code>database.url</code> includes</p>
<div class="listingblock">
<div class="content">
<pre>useUnicode=true&amp;characterEncoding=UTF-8</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you use older versions of MariaDB or MySQL (&lt; 8), you may have to set the following property in the <code>settings.properties</code> file:
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>spring.datasource.hikari.connectionInitSql=SET NAMES utf8mb4 COLLATE utf8mb4_bin;</pre>
</div>
</div>
</li>
<li>
<p>change the <code>my.conf</code> MariaDB database configuration file if necessary to use <code>utf8mb4</code> as default character set and <code>utf8mb4_bin</code> for collation (see <a href="#character-set-config">Preparing the database</a>).</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_using_mysql_instead_of_mariadb"><a class="anchor" href="#_using_mysql_instead_of_mariadb"></a>Using MySQL instead of MariaDB</h4>
<div class="paragraph">
<p>INCEpTION only includes the MariaDB JDBC driver. According to the MariaDB documentation, this driver is also compatible with MySQL servers. However, additional settings may be necessary when connecting to a MySQL server.</p>
</div>
<div class="paragraph">
<p>If you want to use INCEpTION with MySQL instead of MariaDB, you may also have to explicitly define the database driver. The MariaDB driver should also work for MySQL databases, but if you use a <code>mysql</code> JDBC URL (like e.g. <code>dbc:mysql://localhost:3306/inception</code>), you need to explicitly define the driver in the <code>settings.properties</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>database.driver=org.mariadb.jdbc.Driver</pre>
</div>
</div>
<div class="paragraph">
<p>In most cases, INCEpTION can auto-configure the database dialect to use. However, in some cases, this auto-detection may fail - in particular when using MySQL. For example, when using INCEpTION with MySQL 8, it may be necessary to explicitly add a database dialect configuration to the <code>settings.properties</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>database.dialect=org.hibernate.dialect.MySQL8Dialect</pre>
</div>
</div>
<div class="paragraph">
<p>Finally, recent versions of MySQL may need this setting to avoid schema validation to fail during startup:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>spring.jpa.properties.hibernate.globally_quoted_identifiers=true</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_hsqldb_embedded"><a class="anchor" href="#_hsqldb_embedded"></a>HSQLDB (embedded)</h3>
<div class="paragraph">
<p>INCEpTION displays a warning in the user interface when an embedded database is being used.
It is not recommended to used an embedded database for various reasons:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>HSQLDB databases are known to run a risk of becoming corrupt in case of power failures which may
render the application inaccessible and your data difficult to recover.</p>
</li>
<li>
<p>In very rare cases it may be necessary to fix the database content which is more inconvenient
for embedded databases.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In case that you really want to run INCEpTION with an embedded database in production,
you probably want to disable this warning. To do so, please add the following entry to
the <code>settings.properties</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>warnings.embeddedDatabase=false</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_running_via_embedded_tomcat_jar"><a class="anchor" href="#_running_via_embedded_tomcat_jar"></a>Running via embedded Tomcat (JAR)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The INCEpTION standalone JAR with an embedded Tomcat server and can be easily set up as a UNIX service.
This is the recommended way of running INCEpTION on a server.</p>
</div>
<div class="paragraph">
<p>The instructions below expect a Debian Linux system.
Details may vary on other OSes and Linux distributions.</p>
</div>
<div class="sect2">
<h3 id="_installing_as_a_service"><a class="anchor" href="#_installing_as_a_service"></a>Installing as a service</h3>
<div class="paragraph">
<p>To set it up as a service, you can do the following steps.
For the following example, we assume that you install INCEpTION in <code>/srv/inception</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Copy the standalone JAR file <code>inception-app-standalone-30.0.jar</code> to <code>/srv/inception/inception.jar</code>.
Note the change of the filename to <code>inception.jar</code>.</p>
</li>
<li>
<p>Create the file <code>/srv/inception/inception.conf</code> with the following content</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">JAVA_OPTS="-Djava.awt.headless=true -Dinception.home=/srv/inception"</code></pre>
</div>
</div>
</li>
<li>
<p>In the previous step, you have already created the <code>/srv/inception/settings.properties</code> file.
You <strong>may optionally</strong> configure the Tomcat port using the following line</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">server.port=18080</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you need to do additional configurations of the embedded Tomcat, best refer to the documentation of Spring Boot itself.</p>
</div>
</li>
<li>
<p>We will run INCEpTION as the user <code>www-data</code>.
Change the owner/group of <code>/srv/inception/inception.jar</code> to <code>www-data</code>.
<strong>Do NOT run INCEpTION as root.</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ chown www-data:www-data /srv/inception/inception.jar</code></pre>
</div>
</div>
</li>
<li>
<p>Make the JAR file executable:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ chmod +x /srv/inception/inception.jar</code></pre>
</div>
</div>
</li>
<li>
<p>Create a file <code>/etc/systemd/system/inception.service</code> with the following content:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">[Unit]
Description=INCEpTION

[Service]
ExecStart=/srv/inception/inception.jar
User=www-data

[Install]
WantedBy=multi-user.target</code></pre>
</div>
</div>
</li>
<li>
<p>Enable the INCEpTION service using</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ systemctl enable inception</code></pre>
</div>
</div>
</li>
<li>
<p>Start INCEpTION using</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ systemctl start inception</code></pre>
</div>
</div>
</li>
<li>
<p>Check the log output</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ journalctl -u inception</code></pre>
</div>
</div>
</li>
<li>
<p>Stop INCEpTION using</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ systemctl stop inception</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you encounter strange errors, e.g. <code>{status=203/EXEC}</code>  and INCEpTION starts when directly executing the jar but not via systemd, then we recommend to disable SELinux.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_loading_extra_java_libraries"><a class="anchor" href="#_loading_extra_java_libraries"></a>Loading extra Java libraries</h3>
<div class="paragraph">
<p>When running an application from a fat JAR (i.e. using <code>java -jar &#8230;&#8203;</code>), there is no way that you can specify extra libraries for the application to load (e.g. a database driver).
Therefore,
INCEpTION offers a special approach that works around this limitation.</p>
</div>
<div class="paragraph">
<p>In order to have the application load additional JAR files during startup, create a folder <code>lib</code> in the application home folder.
Place any JARs that you want to load into that folder.</p>
</div>
<div class="paragraph">
<p>To check if the loading works as expected, you can add the parameter <code>-Dloader.debug=true</code> when starting up INCEpTION.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sect_reverse_proxy"><a class="anchor" href="#sect_reverse_proxy"></a>Running the behind a reverse proxy (JAR)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>These are <strong>optional</strong> instructions if you want to run INCEpTION behind an Apache HTTPD, Nginx or Caddy web-server instead of accessing it directly.</p>
</div>
<div class="paragraph">
<p>These guides assumes Debian 9.1 (Stretch) as the operating system.
For the optional SSL configuration, it further assumes that you want to use <a href="https://letsencrypt.org/">Let&#8217;s Encrypt</a> as a CA for obtaining valid SSL certificates.</p>
</div>
<div class="paragraph">
<p>The setup for INCEpTION itself is the same for Apache, Nginx and Caddy:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add the following lines to <code>/srv/inception/settings.properties</code> (replacing <code>your.public.domain.name.com</code> with the public domain name of your reverse proxy):</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text"># Port INCEpTION is listening on
server.port=8080

# If your reverse proxy is running on the same host as {product-name},
# you can use the next line to prevent direct access to INCEpTION from other hosts
server.address=127.0.0.1

# In our examples, we run {product-name} at `your.public.domain.name.com/inception`
# If you want to Run {product-name} directly under the host name without an
# additional path, remove this line
server.servlet.context-path=/inception

# Tell {product-name} which URL your users will enter into their browsers to access it.
# Make sure you have an entry with and an entry without the protocol.
# If you also allow unencrypted http (not recommended) then also add a line with
# the http protocol
wicket.core.csrf.accepted-origins[0]=your.public.domain.name.com
wicket.core.csrf.accepted-origins[1]=https://your.public.domain.name.com</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_csrf_protection"><a class="anchor" href="#_csrf_protection"></a>CSRF protection</h3>
<div class="paragraph">
<p>Depending on your situation, you may get an error message such as this when trying to use
INCEpTION.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Whitelabel Error Page This application has no explicit mapping for /error, so you are seeing this as a fallback.</p>
</div>
<div class="paragraph">
<p>Fri Nov 29 14:01:15 BRT 2019 There was an unexpected error (type=Bad Request, status=400).
Origin does not correspond to request</p>
</div>
</div>
</div>
<div class="paragraph">
<p>If this is the case, then CSRF protection is kicking in.
Check that the following lines are in your <code>settings.properties</code> file (see <a href="#sect_settings">[sect_settings]</a>, replace the server name and URL with your own):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>wicket.core.csrf.accepted-origins[0]=your.public.domain.name.com
wicket.core.csrf.accepted-origins[1]=https://your.public.domain.name.com</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You could disable CSRF completely, but this is obviously not the recommended approach. To disable CSRF, add <code>wicket.core.csrf.enabled=false</code> to the <code>settings.properties</code> file.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_apache_httpd_as_reverse_proxy"><a class="anchor" href="#_apache_httpd_as_reverse_proxy"></a>Apache HTTPD as reverse proxy</h3>
<div class="exampleblock">
<div class="content">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Make sure you have read the <a href="#sect_reverse_proxy">general instructions</a> for running behind
       a reverse proxy and have configured your <a href="#sect_settings">settings file</a> accordingly, otherwise you will not be able
       to properly use INCEpTION via the reverse proxy!
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="paragraph">
<p>This assumes that you already have the following packages installed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Apache Web Server</p>
</li>
<li>
<p>mod_proxy</p>
</li>
<li>
<p>mod_proxy_http</p>
</li>
<li>
<p>mod_wstunnel</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can enable the two modules with</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ a2enmod proxy proxy_http wstunnel</code></pre>
</div>
</div>
<div class="paragraph">
<p>and check that they are enabled with</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ apachectl -M</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Edit <code>/etc/apache2/conf-available/inception.local.conf</code> (alternatively, you may want to configure a new virtual host for INCEpTION)</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">ProxyPreserveHost On

&lt;Proxy http://localhost/inception &gt;
  Order Deny,Allow
  Deny from none
  Allow from all
&lt;/Proxy&gt;

ProxyPass /inception/ws ws://localhost:8080/inception/ws
ProxyPass /inception http://localhost:8080/inception
ProxyPassReverse /inception https://your.public.domain.name.com/inception</code></pre>
</div>
</div>
</li>
<li>
<p>Enable the configuration with</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ a2enconf inception.local</code></pre>
</div>
</div>
</li>
<li>
<p>Restart Apache web server</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ service apache2 restart</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_obtaining_a_lets_encrypt_certificate"><a class="anchor" href="#_obtaining_a_lets_encrypt_certificate"></a>Obtaining a Let&#8217;s Encrypt certificate</h4>
<div class="paragraph">
<p>The Certification Authority (CA) <em>Let&#8217;s Encrypt</em> provides free TLS/SSL certificates.
These certificates allow for secure HTTPS connections on web servers.
<em>Let&#8217;s Encrypt</em> provides the software Certbot which automates the obtaining process for Apache.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://backports.debian.org/Instructions/">Enable the Stretch backports repo</a> if needed</p>
</li>
<li>
<p>Enable mod_ssl</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>$ sudo a2enmod ssl</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Install Certbot preconfigured for Apache</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>$ apt-get install python-certbot-apache -t stretch-backports</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Obtain the certificates for your domain <code>example.com</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>$ certbot --apache certonly -d example.com</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>You will be prompted to enter your e-mail address and asked to agree to the terms of service.
Certificate renewal information will be sent to this e-mail.
If the certification process is successful it will yield the information where your certificates can be found.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>IMPORTANT NOTES:
 - Congratulations! Your certificate and chain have been saved at
   /etc/letsencrypt/live/example.com/fullchain.pem. Your cert will
   expire on 2019-04-22. To obtain a new or tweaked version of this
   certificate in the future, simply run certbot again with the
   "certonly" option. To non-interactively renew *all* of your
   certificates, run "certbot renew"
 - Your account credentials have been saved in your Certbot
   configuration directory at /etc/letsencrypt. You should make a
   secure backup of this folder now. This configuration directory will
   also contain certificates and private keys obtained by Certbot so
   making regular backups of this folder is ideal.
 - If you like Certbot, please consider supporting our work by:

   Donating to ISRG / Let's Encrypt:   https://letsencrypt.org/donate
   Donating to EFF:                    https://eff.org/donate-le</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Certificates issued by <em>Let&#8217;s Encrypt</em> are valid for 90 days.
You will receive an expiry notification to the e-mail address you provided during the certification process.
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>Run Certbot with the command <code>renew</code> to renew all certificates that are due.
You can also create a cron job for this purpose.
The command for renewal is</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>$ certbot --apache renew</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>You can simulate the certificate renewal process with the command</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>$ certbot --apache renew --dry-run</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The directory <code>/etc/letsencrypt/live/example.com/</code> now contains the necessary certificates to proceed</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>$ ls /etc/letsencrypt/live/example.com
Output:
cert.pem  chain.pem  fullchain.pem  privkey.pem</pre>
</div>
</div>
<div class="paragraph">
<p>Then the configuration of the web server only needs this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">&lt;VirtualHost *:443&gt;
    ServerName example.com
    DocumentRoot /var/www/html
    SSLEngine on
    SSLCertificateFile /etc/letsencrypt/live/example.com/fullchain.pem
    SSLCertificateKeyFile /etc/letsencrypt/live/example.com/privkey.pem
    Include /etc/letsencrypt/options-ssl-apache.conf
&lt;/VirtualHost&gt;

&lt;VirtualHost *:80&gt;
    ServerName example.com
    Redirect / https://example.com/
    RewriteEngine on
    RewriteCond %{SERVER_NAME} =example.com
    RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,NE,R=permanent]
&lt;/VirtualHost&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_nginx_as_reverse_proxy"><a class="anchor" href="#_nginx_as_reverse_proxy"></a>NGINX as reverse proxy</h3>
<div class="exampleblock">
<div class="content">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Make sure you have read the <a href="#sect_reverse_proxy">general instructions</a> for running behind
       a reverse proxy and have configured your <a href="#sect_settings">settings file</a> accordingly, otherwise you will not be able
       to properly use INCEpTION via the reverse proxy!
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="paragraph">
<p>This section describes using <a href="https://www.nginx.com/">NGINX</a> as a web server serving as a reverse proxy for INCEpTION.
It further assumes that you want to use <a href="https://letsencrypt.org/">Let&#8217;s Encrypt</a> as a CA for obtaining valid SSL certificates.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You can install NGINX by typing</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>$ apt-get update
$ apt-get install nginx</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Verify the installation with</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>$ systemctl status nginx
Output:
 nginx.service - A high-performance web server and a reverse proxy server
   Loaded: loaded (/lib/systemd/system/nginx.service; enabled; vendor preset: enabled)
   Active: active (running) since Mon 2019-01-21 14:42:01 CET; 20h ago
     Docs: man:nginx(8)
  Process: 7947 ExecStop=/sbin/start-stop-daemon --quiet --stop --retry QUIT/5 --pidfile /run/nginx.pid (code=exited, status=0/SUCCESS)
  Process: 7953 ExecStart=/usr/sbin/nginx -g daemon on; master_process on; (code=exited, status=0/SUCCESS)
  Process: 7950 ExecStartPre=/usr/sbin/nginx -t -q -g daemon on; master_process on; (code=exited, status=0/SUCCESS)
 Main PID: 7955 (nginx)
    Tasks: 9 (limit: 4915)
   CGroup: /system.slice/nginx.service
           7955 nginx: master process /usr/sbin/nginx -g daemon on; master_process on;
           7956 nginx: worker process</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>You can stop, start or restart NGINX with</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>$ systemctl stop nginx

$ systemctl start nginx

$ systemctl restart nginx</pre>
</div>
</div>
<div class="sect3">
<h4 id="_obtaining_a_lets_encrypt_certificate_2"><a class="anchor" href="#_obtaining_a_lets_encrypt_certificate_2"></a>Obtaining a Let&#8217;s Encrypt certificate</h4>
<div class="paragraph">
<p>The Certification Authority (CA) <em>Let&#8217;s Encrypt</em> provides free TLS/SSL certificates.
These certificates allow for secure HTTPS connections on web servers.
<em>Let&#8217;s Encrypt</em> provides the software Certbot which automates the obtaining process for NGINX.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://backports.debian.org/Instructions/">Enable the Stretch backports repo</a> if needed</p>
</li>
<li>
<p>Install Certbot preconfigured for NGINX</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>$ apt-get install python-certbot-nginx -t stretch-backports</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Obtain the certificates for your domain <code>example.com</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>$ certbot --nginx certonly -d example.com</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>You will be prompted to enter your e-mail address and asked to agree to the terms of service.
Certificate renewal information will be sent to this e-mail.
If the certification process is successful it will yield the information where your certificates can be found.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>IMPORTANT NOTES:
 - Congratulations! Your certificate and chain have been saved at
   /etc/letsencrypt/live/example.com/fullchain.pem. Your cert will
   expire on 2019-04-22. To obtain a new or tweaked version of this
   certificate in the future, simply run certbot again with the
   "certonly" option. To non-interactively renew *all* of your
   certificates, run "certbot renew"
 - Your account credentials have been saved in your Certbot
   configuration directory at /etc/letsencrypt. You should make a
   secure backup of this folder now. This configuration directory will
   also contain certificates and private keys obtained by Certbot so
   making regular backups of this folder is ideal.
 - If you like Certbot, please consider supporting our work by:

   Donating to ISRG / Let's Encrypt:   https://letsencrypt.org/donate
   Donating to EFF:                    https://eff.org/donate-le</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Certificates issued by <em>Let&#8217;s Encrypt</em> are valid for 90 days.
You will receive an expiry notification to the e-mail address you provided during the certification process.
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>Run Certbot with the command <code>renew</code> to renew all certificates that are due.
You can also create a cron job for this purpose.
The command for renewal is</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>$ certbot --nginx renew</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>You can simulate the certificate renewal process with the command</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>$ certbot --nginx renew --dry-run</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The directory <code>/etc/letsencrypt/live/example.com/</code> now contains the necessary certificates to proceed</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>$ ls /etc/letsencrypt/live/example.com
Output:
cert.pem  chain.pem  fullchain.pem  privkey.pem</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_putting_it_all_together"><a class="anchor" href="#_putting_it_all_together"></a>Putting it all together</h4>
<div class="paragraph">
<p>By now you should have</p>
</div>
<div class="ulist">
<ul>
<li>
<p>INCEpTION running on port 8080</p>
</li>
<li>
<p>NGINX running with default configurations on port 80</p>
</li>
<li>
<p>your issued SSL certificates</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you are running INCEpTION on a different port than 8080, please make sure to adjust the configurations below accordingly!
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We will now configure NGINX to proxy pass all traffic received at <code>example.com/inception</code> to our INCEpTION instance.</p>
</div>
<div class="paragraph">
<p>Create a new virtual host for your domain.
Inside of <code>/etc/nginx/sites-available/</code> create a new file for your domain (e.g. <code>example.com</code>).
Paste the following contents:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># Server block for insecure http connections on port 80. Redirect to https on port 443
server {
        listen          80;
        listen          [::]:80;
        server_name     example.com;
        return          301 https://$server_name$request_uri;
}

# Server block for secure https connections
server {
        listen 443 ssl;
        listen [::]:443 ssl;
        server_name inception.example.com;

        ssl on;

        # Replace certificate paths
        ssl_certificate         /etc/letsencrypt/live/example.com/fullchain.pem;
        ssl_certificate_key     /etc/letsencrypt/live/example.com/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/example.com/fullchain.pem;

        # Modern SSL Config from
        # https://mozilla.github.io/server-side-tls/ssl-config-generator/
        ssl_protocols TLSv1.2;
        ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256';
        ssl_prefer_server_ciphers on;
        ssl_session_timeout 1d;
        ssl_session_tickets off;
        add_header Strict-Transport-Security max-age=15768000;
        ssl_stapling on;
        ssl_stapling_verify on;

        ignore_invalid_headers off; #pass through headers from INCEpTION which are considered invalid by NGINX server.

        # Change body size if needed. This defines the maximum upload size for files.
        client_max_body_size    10M;

        # Uncommend this for a redirect from example.com to example.com/inception
        #location / {
        #    return 301 https://$host/inception;
        #}

        location /inception/ws {
            proxy_pass http://127.0.0.1:8080;
            proxy_http_version 1.1;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "Upgrade";
            proxy_set_header Host $host;
        }

        location ^~ /inception/ {
            proxy_pass http://127.0.0.1:8080/inception/;
            proxy_redirect http://inception.example.com/ /;
            proxy_http_version 1.1;

            proxy_set_header   Host             $host;
            proxy_set_header   X-Real-IP        $remote_addr;
            proxy_set_header   X-Forwarded-For  $remote_addr;
            proxy_set_header   X-Forwarded-Proto $scheme;
            proxy_max_temp_file_size 0;

            proxy_connect_timeout      180;
            proxy_send_timeout         180;
            proxy_read_timeout         180;

            proxy_temp_file_write_size 64k;

            # Required for new HTTP-based CLI
            proxy_request_buffering off;
            proxy_buffering off; # Required for HTTP-based CLI to work over SSL
            proxy_set_header Connection ""; # Clear for keepalive
    }

    # Deny access to Apache .htaccess files. They have no special meaning for NGINX and might leak sensitive information
    location ~ /\.ht {
            deny all;
    }
}</pre>
</div>
</div>
<div class="paragraph">
<p>Create a symlink for the new configuration file to the folder for accessible websites:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ ln -s /etc/nginx/sites-available/example.com /etc/nginx/sites-enabled/example.com</pre>
</div>
</div>
<div class="paragraph">
<p>Test if the NGINX configuration file works without restarting (and possibly breaking) the webserver:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ nginx -t
Output:
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf test is successful</pre>
</div>
</div>
<div class="paragraph">
<p>If the config works restart the webserver to enable the new site</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ service nginx restart</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_caddy_as_a_reverse_proxy"><a class="anchor" href="#_caddy_as_a_reverse_proxy"></a>Caddy as a reverse proxy</h3>
<div class="exampleblock">
<div class="content">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Make sure you have read the <a href="#sect_reverse_proxy">general instructions</a> for running behind
       a reverse proxy and have configured your <a href="#sect_settings">settings file</a> accordingly, otherwise you will not be able
       to properly use INCEpTION via the reverse proxy!
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="paragraph">
<p>This section describes using <a href="https://caddyserver.com/">Caddy</a> as a web server serving as a reverse proxy for INCEpTION.
It further assumes that you want to use the builting funcionality to use <a href="https://letsencrypt.org/">Let&#8217;s Encrypt</a> as a CA for obtaining valid SSL certificates.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You can install caddy by following the steps in <a href="https://caddyserver.com/docs/install">Caddy</a>.
We assume that you will use the default Systemd configuration that comes with e.g. installing Caddy via apt.
Also, we assume that the host you are running Caddy on has a valid DNS entry and is reachable from the internet.</p>
</li>
<li>
<p>Verify the installation with</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>$ systemctl status caddy
 caddy.service - Caddy
   Loaded: loaded (/lib/systemd/system/caddy.service; enabled; vendor preset: enabled)
   Active: active (running) since Wed 2022-04-27 23:17:14 CEST; 2 weeks 5 days ago
     Docs: https://caddyserver.com/docs/
 Main PID: 3541 (caddy)
      CPU: 8min 36.550s
   CGroup: /system.slice/caddy.service
           3541 /usr/bin/caddy run --environ --config /etc/caddy/Caddyfile</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>You can stop, start or restart Caddy with</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>$ systemctl stop caddy

$ systemctl start caddy

$ systemctl restart caddy</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Edit the Caddyfile under <code>/etc/caddy/Caddyfile</code> and paste the following (and adjust it to your own needs):</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>example.com

handle_path "/inception" {
    reverse_proxy 127.0.0.1:8080
}</pre>
</div>
</div>
<div class="paragraph">
<p>After you restart the Caddy service, you now have a running reverse proxy with automatic HTTPS certificates!</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sect_docker"><a class="anchor" href="#sect_docker"></a>Running via Docker</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_quick_start"><a class="anchor" href="#_quick_start"></a>Quick start</h3>
<div class="paragraph">
<p>If you have Docker installed, you can run INCEpTION using</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ docker run -it --name inception -p8080:8080 ghcr.io/inception-project/inception:30.0</code></pre>
</div>
</div>
<div class="paragraph">
<p>The command downloads INCEpTION from GitHub and starts it on port 8080. If this port is not
available on your machine, you should provide another port to the <code>-p</code> parameter.</p>
</div>
<div class="paragraph">
<p>The logs will be printed to the console. To stop the container, press <code>CTRL-C</code>.</p>
</div>
<div class="paragraph">
<p>To run the INCEpTION docker in the background use</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ docker run -d --name inception -p8080:8080 ghcr.io/inception-project/inception:30.0</code></pre>
</div>
</div>
<div class="paragraph">
<p>Logs are accessible by typing</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ docker logs inception</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Use <code>docker run</code> only the first time that you run INCEpTION. If you try it a second time, Docker
      will complain about the name <code>inception</code> already being in use. If you follow Docker`s suggestion
      to delete the container, you will loose all your INCEpTION data. Further below, we explain how
      you can store your data outside the container in a folder on your host.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When you want to run INCEpTION again later, use the command</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ docker start -ai inception</code></pre>
</div>
</div>
<div class="paragraph">
<p>or for the background mode</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ docker start inception</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_storing_data_on_the_host"><a class="anchor" href="#_storing_data_on_the_host"></a>Storing data on the host</h3>
<div class="paragraph">
<p>If you follow the quick start instructions above, INCEpTION will store all its data inside the docker
container. This is normally not what you want because as soon as you delete the container, all data
is gone. That means for example that you cannot easily upgrade to a new version of the INCEpTION
docker image when one is released.</p>
</div>
<div class="paragraph">
<p>To store your data on your host computer, first create a folder where you want to store your data.
For example, if you are on Linux, you could create a folder <code>/srv/inception</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ mkdir /srv/inception</pre>
</div>
</div>
<div class="paragraph">
<p>When you run INCEpTION via Docker, you then mount this folder into the container:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ docker run -it --name inception -v /srv/inception:/export -p8080:8080 ghcr.io/inception-project/inception:30.0</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_settings_file"><a class="anchor" href="#_settings_file"></a>Settings file</h3>
<div class="paragraph">
<p>The dockerized INCEpTION expects the <code>settings.properties</code> file in the <code>/export</code> folder. Instead of
injecting a custom <code>settings.properties</code> file into the container, it is strongly recommender to
use the instructions above (Storing data on the host) to mount a folder from the host system to
<code>/export</code> then to place the into the mounted folder <code>settings.properties</code>. Thus, if you follow
the instructions above, the settings file would go to <code>/srv/inception/settings.properties</code> on the host
system.</p>
</div>
</div>
<div class="sect2">
<h3 id="_connecting_to_a_dedicated_database"><a class="anchor" href="#_connecting_to_a_dedicated_database"></a>Connecting to a dedicated database</h3>
<div class="paragraph">
<p>By default, INCEpTION uses an embedded SQL database to store its metadata (not the texts,
annotations and knowledge bases, these are stored in files on disk). For production use, it is highly
recommended to use a dedicated database server (i.e. MariaDB or compatible) instead of the embedded
SQL database.</p>
</div>
</div>
<div class="sect2">
<h3 id="_memory_and_other_java_options"><a class="anchor" href="#_memory_and_other_java_options"></a>Memory and other Java options</h3>
<div class="paragraph">
<p>By default, {application-name} will use 80% of the memory allocated to the container.
However, if you allocate very little or very much memory to the container, you may want to adjust this.</p>
</div>
<div class="paragraph">
<p>For example, to set the available memory (RAM) to e.g. 4GB, append <code>-Xmx4g</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ docker run -it -e JAVA_OPTS=-Xmx4g ghcr.io/inception-project/inception:30.0</code></pre>
</div>
</div>
<div class="paragraph">
<p>Be sure to leave some memory for the operating system inside the Docker container as well. Instead of setting a fixed value for the memory, you might consider allocating a percentage of the container&#8217;s memory to {application-name} using <code>-XX:MaxRAMPercentage=80</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ docker run -it -e JAVA_OPTS=-XX:MaxRAMPercentage=80 ghcr.io/inception-project/inception:30.0</code></pre>
</div>
</div>
<div class="paragraph">
<p>The applications logs the amount of memory it will use during startup. Check this value to validate that your memory setting takes effect.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>INFO [main] [SYSTEM] boot - Max. application memory: 4096MB
---

You also pass additional options to the Java runtime through the `JAVA_OPTS` environment variable. This also includes system properties, e.g. `-DpropertName=value`. Most of the settings that can be configured in the `settings.properties` file can also be supplied in this way instead.

== Customizing UID/GID

By default, {product-name} runs with the UID 2000 and the GID 2000. On startup, any files belonging to {product-name} are automatically reassigned to these UID/GID, in the Docker container itself as well as in any volume potentially mounted under `/export` within the container. If you need the application to run as a different UID/GID, you can override these values when starting the container using the `APP_UID` and `APP_GID` environment variables.</pre>
</div>
</div>
<div class="paragraph">
<p>$ docker run -it -e APP_UID=1234 -e APP_GID=4321 ghcr.io/inception-project/inception:30.0</p>
</div>
<div class="listingblock">
<div class="content">
<pre>NOTE: If the container is already started using a non-root UID, then `APP_UID` and `APP_GID` have no effect and also
      no changes to the file ownerships in `/export` will be performed. This is e.g. the case when running a container using
      `-u` parameter or using the Kubernetes `runAsUser` setting.

== Docker Compose

Using Docker Compose, you can manage multiple related containers. This section illustrates how to use
Docker Compose to jointly set up a {product-name} container as well as a database container (i.e.
link:https://hub.docker.com/_/mariadb/[this one]).

The following Compose script sets these containers up.

[source,text,subs="+attributes"]
.Docker Compose script</pre>
</div>
</div>
<div class="paragraph">
<p><mark>
# docker-compose up [-d]
# docker-compose down
</mark>
version: '2.4'</p>
</div>
<div class="paragraph">
<p>networks:
  inception-net:</p>
</div>
<div class="paragraph">
<p>services:
  db:
    image: "mariadb:10.7"
    environment:
      - MYSQL_RANDOM_ROOT_PASSWORD=yes
      - MYSQL_DATABASE=inception
      - MYSQL_USER=${DBUSER:-inception}
      - MYSQL_PORT=3306
      - MYSQL_PASSWORD=${DBPASSWORD:-inception}
    volumes:
      - ${INCEPTION_DB_HOME:-db-data}:/var/lib/mysql
    command: ["--character-set-server=utf8mb4", "--collation-server=utf8mb4_bin"]
    healthcheck:
      test: ["CMD", "mysqladmin" ,"ping", "-h", "localhost", "-p${DBPASSWORD:-inception}", "-u${DBUSER:-inception}"]
      interval: 20s
      timeout: 10s
      retries: 10
    networks:
      inception-net:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>  app:
    image: "${INCEPTION_IMAGE:-ghcr.io/inception-project/inception}:${INCEPTION_VERSION:-{revnumber}}"
    ports:
      - "${INCEPTION_PORT:-8080}:8080"
    environment:
      - INCEPTION_DB_DIALECT=org.hibernate.dialect.MariaDB103Dialect 
      - INCEPTION_DB_DRIVER=org.mariadb.jdbc.Driver
      - INCEPTION_DB_URL=jdbc:mariadb://db:3306/inception?useSSL=false&amp;useUnicode=true&amp;characterEncoding=UTF-8
      - INCEPTION_DB_USERNAME=${DBUSER:-inception}
      - INCEPTION_DB_PASSWORD=${DBPASSWORD:-inception}
      - JAVA_OPTS=-Dspring.jpa.properties.hibernate.dialect.storage_engine=innodb
    volumes:
      - ${INCEPTION_HOME:-app-data}:/export
    depends_on:
      db:
        condition: service_healthy
    restart: unless-stopped
    networks:
      inception-net:
      
volumes:
  app-data:
  db-data:</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>Place the script into any folder, change to that folder, and issue the following command to start
the containers.

[source,shell,subs="+attributes"]</pre>
</div>
</div>
<div class="paragraph">
<p>$ docker-compose -p inception up -d</p>
</div>
<div class="listingblock">
<div class="content">
<pre>This will start two docker containers: `inception_db_1`, and `inception_app_1`.
You can check the logs of each by running

[source,shell,subs="+attributes"]</pre>
</div>
</div>
<div class="paragraph">
<p>$ docker logs inception_db_1
$ docker logs inception_app_1</p>
</div>
<div class="listingblock">
<div class="content">
<pre>The actual name of these containers might vary. A list of running containers can be retrieved by

[source,shell,subs="+attributes"]</pre>
</div>
</div>
<div class="paragraph">
<p>$ docker ps</p>
</div>
<div class="listingblock">
<div class="content">
<pre>The data of the containers will be stored in Docker volumes. If you shut the containers down and
start them again later, the data will still be there - try it out!

[source,shell,subs="+attributes"]</pre>
</div>
</div>
<div class="paragraph">
<p>$ docker-compose -p inception down</p>
</div>
<div class="listingblock">
<div class="content">
<pre>You can list the Docker volumes on your system using

[source,shell,subs="+attributes"]</pre>
</div>
</div>
<div class="paragraph">
<p>$ docker volume ls</p>
</div>
<div class="listingblock">
<div class="content">
<pre>If you want to provide a custom `settings.properties` file, you can also choose to mount the data volume
to your hosts file system instead of to a Docker volume by setting the `INCEPTION_HOME` environment
variable to the path you want to store your data in and where you will also put the `settings.properties`
file. You can also choose to override the default location for the database data by setting the
`INCEPTION_DB_HOME` environment variable.

[source,shell,subs="+attributes"]</pre>
</div>
</div>
<div class="paragraph">
<p>$ export INCEPTION_HOME=/srv/inception/app-data
$ export INCEPTION_DB_HOME=/srv/inception/db-data
$ docker-compose -f docker-compose.yml -p inception up</p>
</div>
<div class="listingblock">
<div class="content">
<pre>If you are running Docker on Linux, the data of the volumes should end up on the file system anyway
in a special folder used by Docker. You can figure out which folder that is using
`docker volume inspect ...`. However, if you are running Docker on macOS or Windows, the data is likely to
live in a special virtual machine that is owned by Docker and it will not be easily accessible unless
you mount the data to folders on your host.

NOTE: Mind that you cannot arbitrarily switch between volume-managed and host-stored data. Choose wisely.

There is a lot more that you can do using Docker and Docker Compose. Please see the link:https://docs.docker.com/compose/[docker-compose reference] for details.


:leveloffset!:

:leveloffset: +1

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

[[sect_kubernetes]]
= Running via Kubernetes

NOTE: This is a **very rough** guide on how {application-name} could be deployed using
      Kubernetes. If you are familiar with Kubernetes and cloud deployment, you will
      probably find a lot here that can be improved. Great! Best help us improving this
      guide by sending us your improvement suggestions through
      link:https://github.com/inception-project/inception[GitHub].

The following Kubernetes file sets up {application-name} along with a few volumes.
It does currently **NOT** set up a database container but instead uses the built-in
database **which is not recommended for production environments**. Also, it uses
folders on the host system for volumes. It is only meant as an illustration.
**Be sure to adjust this to your environment and to use a proper database!**

[source,text,subs="+attributes"]
.Kubernetes deployment descriptor</pre>
</div>
</div>
<div class="paragraph">
<p>kind: PersistentVolume
apiVersion: v1
metadata:
  name: inception-data-pv
  labels:
    type: local
spec:
  storageClassName: standard
  capacity:
    storage: 5Gi
  accessModes:
    - ReadWriteOnce
  hostPath:
    path: "/srv/inception-kubernetes/data"
---
kind: PersistentVolume
apiVersion: v1
metadata:
  name: inception-log-pv
  labels:
    type: local
spec:
  storageClassName: standard
  capacity:
    storage: 5Gi
  accessModes:
    - ReadWriteOnce
  hostPath:
    path: "/srv/inception-kubernetes/data"
---
kind: PersistentVolume
apiVersion: v1
metadata:
  name: inception-tmp-pv
  labels:
    type: local
spec:
  storageClassName: standard
  capacity:
    storage: 5Gi
  accessModes:
    - ReadWriteOnce
  hostPath:
    path: "/srv/inception-kubernetes/data"
---
kind: PersistentVolumeClaim
apiVersion: v1
metadata:
  name: inception-data-pvc
spec:
  storageClassName: standard
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 5Gi
---
kind: PersistentVolumeClaim
apiVersion: v1
metadata:
  name: inception-tmp-pvc
spec:
  storageClassName: standard
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 5Gi
---
kind: PersistentVolumeClaim
apiVersion: v1
metadata:
  name: inception-log-pvc
spec:
  storageClassName: standard
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 5Gi
---
apiVersion: v1
kind: Service
metadata:
   name: inception-svc
   labels:
     app: inception
spec:
   type: NodePort
   ports:
   - protocol: TCP
     port: 8080
     targetPort: 8080
     nodePort: 32000
   selector:
     app: inception
---     
apiVersion: apps/v1
kind: Deployment
metadata:
  name: inception
spec:
  selector:
    matchLabels:
      app: inception
  replicas: 1
  template:
    metadata:
      labels:
        app: inception
    spec:
      securityContext:
        runAsUser: 2000
        runAsGroup: 2000
        fsGroup: 2000
        runAsNonRoot: true
      containers:
      - name: inception
        image: "ghcr.io/inception-project/inception-snapshots:30.0"
        imagePullPolicy: Always
        ports:
        - containerPort: 8080
        securityContext:
          readOnlyRootFilesystem: true
          privileged: false
        volumeMounts:
        - mountPath: /export
          name: inception-data-pv
        - mountPath: /tmp
          name: inception-tmp-pv
        - mountPath: /var/log
          name: inception-log-pv
      volumes:
      - name: inception-data-pv
        persistentVolumeClaim:
          claimName: inception-data-pvc
      - name: inception-tmp-pv
        persistentVolumeClaim:
          claimName: inception-tmp-pvc
      - name: inception-log-pv
        persistentVolumeClaim:
          claimName: inception-log-pvc</p>
</div>
<div class="listingblock">
<div class="content">
<pre>To deploy an {application-name} service copy this to a file called `inception.yml` and then run it using

[source,text]
.Create Kubernetes environment</pre>
</div>
</div>
<div class="paragraph">
<p>$ kubectl create -f inception.yml</p>
</div>
<div class="listingblock">
<div class="content">
<pre>To delete the service again, use

[source,text]
.Delete Kubernetes environment</pre>
</div>
</div>
<div class="paragraph">
<p>$ kubectl delete -f inception.yml</p>
</div>
<div class="listingblock">
<div class="content">
<pre>This can be tested e.g. using the Kubernetes support built into recent Docker Desktop. If you experience problems, make sure you run the latest version of Docker Desktop.

:leveloffset: 1

:leveloffset: +1

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

= Unsupervised installation

To perform an unsupervised installations of {product-name}, you can:

* set a custom password for the default `admin` account
* create the `admin` account with the `ROLE_REMOTE`
* enable/disable telemetry support to avoid the admin being asked on the first login

.Custom default admin user/password
To set a custom default admin user name and password, add the following line to the `settings.properties`
file. If no custom user name is set, the default `admin` is used.:

```
security.default-admin-username=mastermind
security.default-admin-password={bcrypt}XXXXXX
```

To obtain an encrypted password, you can use tools such as the
link:https://bcrypt-generator.com[online bcrypt generator]. Replace the XXXXXX in the example
above with the output from the tool - keep the `{bcrypt}` prefix!

You could also create a user in {product-name}, set the password you desire, and then look at the
database table `users` (easiest if you are using MariaDB or MySQL).

.Enable remote API access for the admin user

If you want your installation to be remotely manageable directly from the outset using the `admin`
account, you can add the following line:

```
security.default-admin-remote-access=true
```

Mind that the remote API still needs to be enabled separately.

.Enable/disable telemetry

You can use either of the following two lines to enable or disable telemetry submission and avoid
the `admin` user being asked about telemetry submission on the first login.

```
telemetry.auto-respond=ACCEPT
telemetry.auto-respond=REJECT
```

:leveloffset: 1

&lt;&lt;&lt;

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

[[sect_logging]]
= Logging

{product-name} comes with a default logging configuration that should serve well in a normal
production environment, either on a server or running as a desktop application. However, for
more advanced scenarios, it may be useful to customize the logging configuration.

== Set specific log levels

Maybe you do not want to user a completely custom logging configuration and only wish to get a bit
more information in a particular part of the application. In this case, you can specify the log
level for particular packages or classes either by declaring logging properties either as system
property (`-D`) argument when starting {product-name} or by adding them to the `settings.properties`
file. For example, if you wanted to get more information on the authentication process, you could
use the following properties:

[source,text]</pre>
</div>
</div>
<div class="paragraph">
<p>logging.level.org.springframework.security=TRACE
logging.level.de.tudarmstadt.ukp.inception.security=TRACE</p>
</div>
<div class="listingblock">
<div class="content">
<pre>== Custom logging

A custom logging configuration can be specified when starting up {product-name} using the parameter
`-Dlogging.config=/path/to/your/log4.xml`. This should be a standard Log4J2 configuration file.
A good starting point is the default configuration used by {product-name} which can be found in link:https://github.com/inception-project/inception/blob/main/inception/inception-app-webapp/src/main/resources/log4j2-spring.xml[our code repository].

== Logging in JSON format

If you would like to integrate the logging output of {product-name} with something like LogStash and
Kibana, you may want log output to be in a properly interpretable JSON format, instead of the usual
plain text format. {product-name} comes with several JSON configurations that are compatible with
popular tools like LogStash and others. You can activate it by adding the following sections to a custom `log4j2.xml` file in the `Appenders` sections and in the `Root` logger.

[source,text]</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;Configuration &#8230;&#8203;&gt;
  &lt;!-- &#8230;&#8203; -&#8594;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;Appenders&gt;
  &lt;!-- ... --&gt;</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;RollingFile name="RollingFileAppender" fileName = "logs/inception.log"
             filePattern="app-%d{MM-dd-yy-HH-mm-ss}-%i.log.gz"&gt;
    &lt;JsonTemplateLayout eventTemplateUri="classpath:LogstashJsonEventLayoutV1.json"/&gt;
  &lt;Policies&gt;
    &lt;SizeBasedTriggeringPolicy size = "20 MB" /&gt;
  &lt;/Policies&gt;
&lt;/RollingFile&gt;</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>  &lt;!-- ... --&gt;
&lt;/Appenders&gt;</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;Loggers&gt;
  &lt;!-- ... --&gt;</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;Root level="warn"&gt;
  &lt;!-- ... --&gt;</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>    &lt;AppenderRef ref="RollingFileAppender" /&gt;
  &lt;/Root&gt;
&lt;/Loggers&gt;&lt;/Configuration&gt;</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>The following bundled default configurations that are part of the `log4j-layout-template-json` library
are available in {product-name}:

* `EcsLayout.json`
* `GcpLayout.json`
* `GelfLayout.json`
* `JsonLayout.json`
* `LogstashJsonEventLayoutV1.json`
* `StackTraceElementLayout.json`

&lt;&lt;&lt;

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

= Monitoring

== Available metrics

We expose some metrics of the running {product-name} instance via JMX. These are currently

* the number of active as well as enabled users
* the overall number of documents
* the number of enabled recommenders
* the number of annotation documents i.e. documents being annotated per user

To make the metrics available `spring.jmx.enabled=true`
and `monitoring.metrics.enabled=true`
must be set in the `settings.properties` file
(see &lt;&lt;sect_home_folder&gt;&gt; on this file).

== Setting up metrics exporter

To export the metrics so they can be queried by the monitoring solution https://prometheus.io/[Prometheus],
you can e.g. use https://github.com/prometheus/jmx_exporter[the JMX exporter] as a java agent.

The JMX exporter can be run as a .jar file that should be placed together with its `config.yml`
file next to the {product-name} .jar file. An example `config.yml` file that exposes metrics from
INCEpTION but not webanno brat metrics (metrics associated with brat rendering) and conforms JMX metric
names to https://prometheus.io/docs/practices/naming/[Prometheus Naming conventions] is:

....
ssl: false
whitelistObjectNames: ["de.tudarmstadt.ukp.inception.recommendation.metrics:*",
"de.tudarmstadt.ukp.clarin.webanno.api.dao.metrics:*", "de.tudarmstadt.ukp.clarin.webanno.security.metrics:*"]
blacklistObjectNames: ["de.tudarmstadt.ukp.clarin.webanno.brat.metrics:*"]
lowercaseOutputName: true
lowercaseOutputLabelNames: true
rules:
  - pattern: 'de.tudarmstadt.ukp.inception.recommendation.metrics&lt;name=recommendationMetricsImpl, type=RecommendationMetricsImpl&gt;&lt;&gt;(\w+): (\d+)'
    name: inception_$1
    value: $2
    help: "Inception metric $1"
    type: GAUGE
    attrNameSnakeCase: true

  - pattern: 'de.tudarmstadt.ukp.clarin.webanno.([\.\w]+).metrics&lt;name=(\w+), type=(\w+)&gt;&lt;&gt;(\w+): (\d+)'
    name: webanno_$4
    value: $5
    help: "Inception metric $4"
    type: GAUGE
    attrNameSnakeCase: true
....

The following line will run the JMX exporter for the JVM that runs the inception.jar.
The exporter will expose the metrics on the http-endpoint _localhost:9404_.
Make sure to use a port, 9404 in this case, that is not open to the public
(only to the local network that your Prometheus instance runs in).

....
java -javaagent:./jmx_prometheus_javaagent-0.13.0.jar=9404:config.yaml -jar inception.jar
....

The JMX exporter will also automatically expose JVM metrics in the `java.lang` namespace
which can be used to e.g. monitor memory usage:

* _jvm_memory_bytes_used_: Used bytes of a given JVM memory area.
* _jvm_memory_bytes_committed_: Committed (bytes) of a given JVM memory area. This means (opposed to max memory)
that this memory is available to the JVM.

and others.

== Sentry
In order to use Sentry as an error tracker, you will need to provide the Sentry SDK your Sentry project's Data Source Name (DSN) and other settings in {product-name}'s `settings.properties` file. The Sentry SDK will be deactivated unless a DSN is provided.

|===
| Setting | Description | Default | Example(s)

| `sentry.dsn`
| The DSN tells the Sentry SDK where to send events.
| `null`
| https://examplePublicKey@o0.ingest.sentry.io/0 https://examplePublicKey@sentry.your-org.com/N

| `sentry.environment`
| Set the application environment that will be sent with each event.
| production
| prod

| `sentry.enable-tracing`
| Enable transaction tracing used for performance monitoring.
| false
| true

| `sentry.traces-sample-rate`
| Adjust the procentage of transaction sent to Sentry.
| 1.0
| 0.2

| `sentry.send-default-pii`
| By default, the Sentry SDK do not purposefully send Personally Identifiable Information (PII) to your Sentry server.
| off
| on
|===

By default, only unhandled exceptions are sent to Sentry. This behavior can be tuned through configuring the `sentry.exception-resolver-order` property. For example, setting it to `-2147483647` (the value of `org.springframework.core.Ordered#HIGHEST_PRECEDENCE`) ensures exceptions that have been handled by exception resolvers with higher order are sent to Sentry - including ones handled by `@ExceptionHandler` annotated methods.

More option that can be overwritten are listed in https://docs.sentry.io/platforms/java/guides/spring-boot/configuration/[the official Sentry SDK ducumentation].

== Scheduling
The default schedule for pulling of Prometheus is 10s, however it is necessary to make this a longer
interval to avoid overwhelming your {product-name} instance with requests for metrics.
You will need to do this in your Prometheus config file.


&lt;&lt;&lt;

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

[[sect_upgrade]]
= Upgrading

== Upgrade paths

There are in principle three ways to upgrade {product-name} to a new version:

* **In-place update** - in this scenario, you simply stop the application, replace the existing
  {product-name} JAR file with the new version, and then start the application again. The benefit
  of this approach is, that is is very fast. The downside is, that in case anything goes wrong, you
  cannot simply go back to using the old version. You need to make sure that you have a proper
  backup of the application home folder and the database (if you use an external database) because
  the in-place update might migrate your data and after you might no longer be able to use it with
  an older version (e.g. if you replace the JAR again with an older version). The steps for
  performing an in-place upgrade are specifed in the respective section below.

* **Migrating to a fresh installation** - in this scenario, you would set up a fresh installation
  of the new {product-name} version using a different application home folder and a different database
  than your existing installation. After that, you would move the data of the old installation over
  to the new installation, e.g. by copying the contents of the old application home/database over
  into the new ones. When you start the fresh installation then, it will find the data you just
  copied over, automatically perform a database migration if there were any changes in the database
  schema, and then start up. The benefit of this approach is that in case anything does wrong during
  the upgrade or in case there is a critical problem with the new version, you can always go back
  to using the old installation and e.g. retry the update again at a later time. The steps for
  setting up a new instance are specified in the installation instructions. The steps for copying
  the data over to the new instance are the same as for performing a backup.

* **Copying projects to a fresh installation** - in this scenario, you would export all projects
  from your existing installation. Then you would set up a new installation using a fresh
  application home folder/database. Finally, you would import all the exported projects into this
  new installation. The only situation where this type of upgrade procedure is necessary is, when
  you want to change the database backend, e.g. if you want to switch from an embedded database to
  an external database. Otherwise, there is typically no benefit in following this approach.
  It would only be necessary if a new {product-name} release would completely break its database
  schema and not offer an automatic migration. This typically does never happen since {product-name}
  has support for automatic database migrations these days.  Also note that none of the user's
  passwords are migrated in this way. When you import the projects in the new installation, you need
  to enable the **import missing users** option and after all projects have been imported, you need
  to go through each of the users, enable them, set their roles and set a new password for them.
  Or alternatively, you could copy the contents of the database tables `users` and `authorities`
  from the old database into the new one.

The release notes generally indicate that it is possible to perform an in-place upgrade of the
application. However, before doing an upgrade, it is recommended to create a backup of the
application and data to allow coming back to a working system if case of a problem during the
upgrade. Mind that the upgrade is only completed once the new version has successfully started
because during startup, the application may make changes to the database schema or to the data on
disk.

Also, for certain versions there might be special considerations to be aware of when performing the
upgrade. Always be sure to check the section below **as well as the release notes** of every version
between the version you are upgrading from up to and including the version you are upgrading to.

:leveloffset: +1

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

= Backup your data

* Make a copy of your {product-name} application home folder
* If you are using an external database like MariaDB, make a backup of your {product-name} database,
  e.g. using the link:https://mariadb.com/kb/en/making-backups-with-mysqldump/[mysqldump] command.

NOTE: Make sure that you can actually re-create a working installation by restoring your backup.
      I.e. restore your database export into a fresh database and point a new {product-name} installation
      at using your home folder copy and the restored database and then start the application and check
      that everything is there and working. A backup which cannot be successfully restored is worthless.


:leveloffset: 1

:leveloffset: +1

// Copyright 2015
// Ubiquitous Knowledge Processing (UKP) Lab and FG Language Technology
// Technische Universitt Darmstadt
//
// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

= Performing an in-place upgrade

* Stop the {product-name} service
* Replace the `inception.jar` file with the new version
* Ensure that the file has the right owner/group (usually `www-data`)
* Start the {product-name} service again

:leveloffset: 1

:leveloffset: +1

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

= Upgrade notes

This section summarizes important upgrade notes from the release history of INCEpTION. If you upgrade from any version `X`, carefully read all the upgrade notes for versions later than `X`. In particular, if any of the upgrade notes mentions that an intermediate upgrade to that version must be made before going to a higher version, then first perform all required intermediate upgrades in order.

NOTE: It is a good idea to back up your installation and data before an upgrade. Also make sure that
      you can actually re-create a working installation by restoring your backup. A backup which cannot be
      successfully restored is worthless.

== INCEpTION 25.0

=== Manual intervention for external pre-authentication users

If you use the external pre-authentication feature of {product-name} (i.e. if you run it behind an
authenticating reverse proxy), you need to perform a manual maintenance step. As of this version,
all users that are created via external pre-authentication are added to the realm `preauth`. Any
existing users that were created via pre-authentication need to be moved to this realm manually,
otherwise they will not be able to log in anymore.

This migration can be performed by invoking {product-name} from the command line as:

[source,shell,indent=0,subs="+attributes"]</pre>
</div>
</div>
<div class="paragraph">
<p>java -jar inception-app-webapp-30.0-standalone.jar users migrate-preauthenticated-users --dry-run</p>
</div>
<div class="listingblock">
<div class="content">
<pre>This command only works if {product-name} is configured for external pre-authentication. If you keep
the `settings.properties` file in a non-standard location, you need to specify the the respective
path using `-Dinception.home=/PATH/TO/FOLDER_CONTAINING_SETTINGS_PROPERTIES` **before** the `-jar` in the
command.

The command will migrate all users that have no password (i.e. the `password` in the database is
`null` or an empty encrypted password was stored) and which do also not have `ROLE_REMOTE`. A user
with no password cannot log in via the login form. The remote API does not support external
pre-authentication and always uses the database for authentication. So if the user either has a
password or `ROLE_REMOTE`, it will not be migrated.

The command as shown above will operate in **dry-run** mode and will only print the results of the
migration without actually performing it. You should look at the results to see if you are ok with
them. Then, remove the `--dry-run` argument and run the command again to actually perform the
migration.

The alternative to using this command is to directly update the respective user records in the
`users` table in the database by setting the `realm` of all externally pre-authenticated users to
`preauth`.

=== Configuration property names changed

The following configuration property names from the `settings.properties` file have changed. When you
start {product-name}, warnings will be logged if the old names are used until you rename the
respective properties in your `settings.properties` file. In a future version, the old names will
not be supported anymore and the warnings will be removed.


|===
| Old name | New name | Description

| `login.message`
| `security.login.message`
| Custom message to appear on the login page.

| `login.max-concurrent-sessions`
| `security.login.max-concurrent-sessions`
| Maximum number of concurrently logged-in users.
|===

== INCEpTION 24.0

=== PDF editor

This version includes a new PDF editor and a new PDF format. The old PDF editor and PDF format
still exist, but have been renamed to *PDF (legacy)*. When starting new projects, these old formats
should no longer be used as they have known and unfixable bugs. The new PDF format that is simply
called *PDF* is much more robust.

=== Compression

This version has the ability to compress CAS files on disk. This feature is turned on by default.
If you experience problems and have the feeling that they might be caused by the compression feature,
you can turn it off by adding `cas-storage.compressed-cas-serialization=false` to the `settings.properties`.
The compression typically reduces the size of the CAS file down to around 60% of its actual size.

The compression algorithm being used is link:https://github.com/xerial/snappy-java[Snappy].
On many platforms, a native implementation is used automatically. If no native implementation is
available, a pure-java implementation is used. Due to the reduced size, saving a CAS will take
consume less I/O bandwidth which typically the overall time required to persist a CAS to storage
despite the additional overhead of compression.

The compression setting takes effect whenever a CAS is written to disk. Changing it does not
immediately (de)compress existing CAS files. Instead, they will be slowly converted to being
(de)compressed over time as they are updated by the system as part of normal operations.

Decompressing CAS files is supported starting with INCEpTION 23.9. If you have compressed
CAS files, you cannot downgrade to an older version than 23.9. Also, you cannot import projects
containing compressed CAS files into versions older than 23.9.

=== Full-text indices

This version includes a new version of Apache Lucene which is used for maintaining the full text
indices used for searching in knowledge bases and also used by the annotation search sidebar.

The indices of the knowledge bases should continue to work normally after the upgrade. If you
encounter problems, you can manually trigger an index rebuild by selecting the knowledge base
in the project settings and using the **Rebuild index** button. Note that rebuilding full text
indices only works for local knowledge bases.

The indices used by the annotation search sidebar will not function until they are rebuilt. The
system will automatically trigger the rebuild process when the annotation page is used. However,
in particular for large projects, rebuilding the indices can take very long.

For installations with many or large projects, it is recommended to perform an **offline index rebuild**.
First ensure that {product-name} is not running. Then run INCEpTION from the command line as follows:</pre>
</div>
</div>
<div class="paragraph">
<p>$ java -jar inception-app-webapp-24.0-standalone.jar search reindex</p>
</div>
<div class="listingblock">
<div class="content">
<pre>This command will rebuild the annotation search indices of **all projects** which depending on the
number of projects and their size can add up to **several hours** (although for most people, it
should be pretty fast). When the process is complete, you can restart INCEpTION as usual. Do not try
to start INCEpTION while the process is still running.

== INCEpTION 22.0

This version brings a new project export page which uses WebSocket. If INCEpTION is deployed behind a reverse proxy, this technical changes requires updating the reverse proxy configuration. The admin guide includes an updated section on deploying behind nginx and Apache HTTPD reverse proxies. Additionally, the CSRF settings in the INCEpTION `settings.properties` file need to be updated. The required settings are also described in the admin guide in the section for deploying behind a reverse proxy.

If you have trouble reconfiguring your reverse proxy for WebSocket, it is still possible to switch back to the old export page by adding the following line to the `settings.properties` file:</pre>
</div>
</div>
<div class="paragraph">
<p>dashboard.legacy-export=true</p>
</div>
<div class="listingblock">
<div class="content">
<pre>NOTE: The setting to switch back to the old export page will be removed in later versions. Also, INCEpTION will make more use of the WebSocket protocol in the future. If you have trouble updating your reverse proxy configuration to support WebSocket, please let us know.

== INCEpTION 21.0.1

If you are using MySQL or MariaDB, please ensure that default row format is set to `dynamic`, otherwise, you may get an error like this during upgrade:</pre>
</div>
</div>
<div class="paragraph">
<p>Error creating bean with name 'liquibase' defined in class path resource
[org/springframework/boot/autoconfigure/liquibase/LiquibaseAutoConfiguration$LiquibaseConfiguration.class]:
Invocation of init method failed; nested exception is liquibase.exception.LiquibaseException:
liquibase.exception.MigrationFailedException:
Migration failed for change set de/tudarmstadt/ukp/inception/preferences/model/db-changelog.xml::20210925-1::INCEpTION Team:
Reason: liquibase.exception.DatabaseException: (conn=242839) Index column size too large. The maximum column size is 767 bytes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>To set the default row format, you can add these settings to your MySQL/MariaDB config file and then restart the database:</pre>
</div>
</div>
<div class="paragraph">
<p>innodb_strict_mode=1
innodb_default_row_format='dynamic'</p>
</div>
<div class="listingblock">
<div class="content">
<pre>If you upgrade from a version older than 20.0, please check the update notes for INCEpTION 20.0.

== INCEpTION 20.0

*  **New versioning.** INCEpTION has come a long way and the time has come to reflect that in the version. So as of this release, we are dropping the the zero from the version!
*  **Database driver changed.** The MySQL driver is no longer bundled, only the MariaDB driver is shipped. If you have manually configured a DB driver and dialect in the `settings.properties`, comment them out. In the JDBC connection string replace `mysql` with `mariadb`. The MariaDB driver should also work with a MySQL database. If you use Docker Compose, make sure to remove the `INCEPTION_DB_DIALECT` and `INCEPTION_DB_DRIVER` and update the `INCEPTION_DB_URL` to start with `jdbc:mariadb:` instead of `jdbc:mysql:`. For additional details, please check the section on MariaDB configuration in the admin guide.
*  **Increased disk usage.** Internal backup for CAS (annotation) files enabled to keep 2 backups with min 24h in between - this change increases disk usage! If you operate with low disk space, consider disabling the internal backup.

== INCEpTION 0.16.0

For deployments using AJP and Apache Webserver 2.5 or higher: to use the advanced AJP secret, see the updated section on running INCEpTION behind a reverse proxy in the admin guide..
For deployments using AJP and Apache Webserver 2.4 or lower: you need to disable the AJP secret by setting `server.ajp.port` (replaces `tomcat.ajp.port`) and `server.ajp.address` properties as described in the admin guide and also set `server.ajp.secret-required=false`.

== INCEpTION 0.15.2

For deployments via WAR-file on Apache Tomcat, Apache Tomcat 9.0. is now necessary. Note that we do not recommend a WAR deployment and do not distribute a pre-built WAR file.

== INCEpTION 0.12.0

If you are running INCEpTION behind a reverse proxy and have so far had a line like `server.contextPath=/XXX` in your `settings.properties` file, please replace it with `server.servlet.context-path=/XXX`.


:leveloffset: 1

&lt;&lt;&lt;

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

[[sect_remote_api]]
= Remote API

====
NOTE: To use this functionality, you need to enable it first by adding `remote-api.enabled=true` to the `settings.properties` file (see the &lt;&lt;admin-guide.adoc#sect_settings, Admin Guide&gt;&gt;).
====

In order to programmatically manage annotation project, a REST-like remote API is offered. This API
is disabled by default. In order to enable it, add the setting `remote-api.enabled=true` to the
`settings.properties` file.

.Remote API settings
[cols="4*", options="header"]
|===
| Setting
| Description
| Default
| Example

| `remote-api.enabled`
| Enable remote API
| `false`
| `true`

| `remote-api.http-basic.enabled`
| Enable HTTP basic authentication
| `true`
| `false`

| `remote-api.oauth2.enabled`
| Enable HTTP basic authentication
| `false`
| `true`

| `remote-api.oauth2.realm`
| Client ID used by the OAuth2 IdP (mandatory if OAuth2 is enabled)
| none
| `inception-client`

| `remote-api.oauth2.user-name-attribute`
| Claim containing the username
| `sub`
| `preferred_username`
|===

Once the remote API is enabled, it becomes possible to assign the role `ROLE_REMOTE` to a user. Create a new user, e.g. `remote-api` via the user management page and assign at least the roles `ROLE_USER` and `ROLE_REMOTE`. Most of the actions accessible through the remote API require administrator access, so adding the `ROLE_ADMIN` is usually necessary as well.

Once the remote API has been enabled, it offers a convenient and self-explanatory web-based user interface under `&lt;APPLICATION_URL&gt;/swagger-ui.html` which can be accessed by any user with the role `ROLE_REMOTE`. Here, you can browse the different operations, their parameters, and even try them out directly via a web browser. The actual AERO remote API uses `&lt;APPLICATION_URL/api/aero/v1` as the
base URL for its operations.

The API follows the link:https://openminted.github.io/releases/aero-spec/1.0.0/omtd-aero/[Annotation Editor Remote Operations (AERO) protocol].

The third-party Python library link:https://pycaprio.readthedocs.io/en/latest/[pycaprio] can be used
to facilitate accessing the remote API.

== OAuth2 authentication

The remote API can be used using OAuth2 authentication. A client is expected to obtain a JWT token
from an OAuth2 endpoint. {product-name} will verify that token using the public key of the OAuth2
endpoint and if the token is valid, access is granted. It is required that the user associated with
then token has been created before in {product-name}. Contrary to OAuth2 logins to the web interface,
logins to the remote API do **not** automatically create users.

Let's consider you are using Keycloak as the OAuth2 provider. First, you would set up a realm in
Keycloak as described in &lt;&lt;sect_security_authentication_oauth2&gt;&gt;. Assuming you followed the example,
you would now open the `inception-client` client in the **clients** panel of the **inception-demo**
realm. There, you have to enable the **Service Accounts** toggle and save.

In the `settings.properties` file, you need to add the following settings to enable OAuth2 login to
the remote API:

```
remote-api.oauth2.enabled=true
remote-api.oauth2.realm=inception-demo
remote-api.oauth2.user-name-attribute=preferred_username
spring.security.oauth2.resourceserver.jwt.issuer-uri=http://localhost:8180/realms/inception-demo
```

Note that you must also have configured OAuth2 authentication for logins to the web interface,
otherwise the next step of creating a user will not be possible.

Enabling the **Service Accounts** option in Keycloak will allow obtaining a JWT token using a
client ID and client credentials. You can find these credentials in the **Credentials** tab of the
`inception-client` client in Keycloak. The preferred username of this service user is automatically
set to `inception-client-service-user` by Keycloak.

Finally, to allow the `inception-client-service-user` to use the remote API, you need to create that
user in {product-name}. Go to the user management section in {product-name} and create a user named
`inception-client-service-user`. Assign at least the roles `ROLE_REMOTE` and `ROLE_USER` to the new user
and set the realm to `external:inception-client`.

NOTE: link:https://pycaprio.readthedocs.io/en/latest/[Pycaprio] does currently not support OAuth2
      authentication - only HTTP basic authentication.


:leveloffset: +1

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

[[sect_remote_api_webhooks]]
= Webhooks

Webhooks allow {product-name} to notify external services about certain events. For example, an
external service can be triggered when an annotator marks a document as finished or when all
documents in a project have been completely curated.

Webhooks are declared in the `settings.properties` file. For every webhook, it is necessary to
specify an URL (`url`) and a set of topics (`topics`) about with the remote service listening at the
given URL is notified. If the remote service is accessible via https and the certificate is not
known to the JVM running {product-name}, the certificate verification can be disabled
(`verify-certificates`).

The following topics are supported:

* `DOCUMENT_STATE` - events related to the change of a document state such as when any user starts
  annotating or curating the document.
* `ANNOTATION_STATE` - events related to the change of an annotation state such as when a user
  starts or completes the annotation of a document.
* `PROJECT_STATE` - events related to the change of an entire project such as when all documents
  have been curated.

.Example webhook configuration</pre>
</div>
</div>
<div class="paragraph">
<p>webhooks.globalHooks[0].url=http://localhost:3333/
webhooks.globalHooks[0].topics[0]=DOCUMENT_STATE
webhooks.globalHooks[0].topics[1]=ANNOTATION_STATE
webhooks.globalHooks[0].topics[2]=PROJECT_STATE
webhooks.globalHooks[0].verify-certificates=false</p>
</div>
<div class="listingblock">
<div class="content">
<pre>TIP: You can test receiving WebHooks e.g. using link:https://pypi.org/project/pyserv/[pyserv] or link:https://en.wikipedia.org/wiki/Netcat[netcat].

== Authentication headers

If the recipient of the webhook requires an authentication header, you can configure the header and
its value.

```
webhooks.globalHooks[0].auth-header=Bearer
webhooks.globalHooks[0].auth-header-value=MY-SECRET-TOKEN
```

== Retries

In some cases, the recipient of a webhook notification may be temporarily unavailable. It is possible to retry the delivery of a notification several times before giving up. By default,
only one delivery attempt is made (`webhooks.retry-count=0`). However, you can configure up to three additional attempts with a delay of up to 5000ms between them.

```
webhooks.retry-count=3
webhooks.retry-delay=5000
```

NOTE: Events being triggered while {product-name} is being shut down may not trigger any webhook deliveries.

== Bulk changes

When performing bulk changes of annotation states (i.e. via the workload management page), no
individual `ANNOTATION_STATE` events are  generated. The document and project states are re-calculated
after the bulk change and depending on whether the bulk action had any effect on them,
`DOCUMENT_STATE` and/or `PROJECT_STATE` events are generated.

== Message examples

When a webhook is triggered, it sends a HTTP `POST` request to the configured URL. The `X-AERO-Notification` header indicates the topic and the body of the request is a JSON structure providing
details about the state change. The JSON in the examples below have been pretty-printed for your
convenient - the actual messages are not pretty-printed.

.Example `PROJECT_STATE`</pre>
</div>
</div>
<div class="paragraph">
<p>{
  "timestamp": 1234567890,
  "projectId": 123,
  "projectName": "Example project",
  "projectPreviousState": "CURATION-IN-PROGRESS",
  "projectState": "ANNOTATION-IN-PROGRESS"
}</p>
</div>
<div class="listingblock">
<div class="content">
<pre>.Example `DOCUMENT_STATE`</pre>
</div>
</div>
<div class="paragraph">
<p>{
  "timestamp": 1234567890,
  "projectId": 123,
  "projectName": "Example project",
  "documentId": 565,
  "documentName": "document.txt",
  "documentPreviousState": "CURATION-IN-PROGRESS",
  "documentState": "ANNOTATION-IN-PROGRESS"
}</p>
</div>
<div class="listingblock">
<div class="content">
<pre>.Example `ANNOTATION_STATE`</pre>
</div>
</div>
<div class="paragraph">
<p>{
  "timestamp": 1234567890,
  "projectId": 123,
  "projectName": "Example project",
  "documentId": 565,
  "documentName": "document.txt",
  "user": "annotator1",
  "annotationUser": "annotator1",
  "annotationPreviousState": "COMPLETE",
  "annotationState": "COMPLETE",
  "annotatorAnnotationState": "IN_PROGRESS",
  "annotatorComment":"Test comment"
}</p>
</div>
<div class="listingblock">
<div class="content">
<pre>In the `ANNOTATION_STATE` message, we have two fields containing a user name: `user` and `annotationUser`.
Usually, these two fields will be the same. They differ if a user changes the state of a document
of another user. An example is when a curator marks the curation of a document as finished. In this
case, the curator's username is in the field `user` while the `annotationUser` field has the value
`CURATION_USER`.

The effective annotation state can be found in the `annotationState` field. However, it can be the
case that a manager has overridden the state, e.g. because an annotator forgot to mark a document
as finished. The `annotatorAnnotationState` field contains the state that was  (implicitly) set by the
annotator.

The `annotatorComment` field contains the comment that annotators can set when closing a document
and is typically used to report a problem with the document. Thus, it can typically be found only
when the `annotatorState` is `COMPLETE` (document closed as successful) or `LOCKED` (document closed
as not successful).

:leveloffset: 1

&lt;&lt;&lt;

// Copyright 2015
// Ubiquitous Knowledge Processing (UKP) Lab and FG Language Technology
// Technische Universitt Darmstadt
//
// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

[[sect_settings]]
= Settings

Application settings are managed via a file called `settings.properties` which must reside in the
application home folder. This file is optional and might need to be created first in the &lt;&lt;admin-guide.adoc#sect_home_folder&gt;&gt;. If the file does not exist, default values are assumed.

:leveloffset: +1

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

= General Settings

.General settings
[cols="4*", options="header"]
|===
| Setting
| Description
| Default
| Example

| `warnings.unsupportedBrowser`
| Warn about unsupported browser
| `true`
| `false`

| `security.login.message`
| Custom message to appear on the login page, such as project web-site, annotation guideline link, ... The message supports markdown syntax.
| _unset_
| `&lt;span style="color:red; font-size: 200%;"&gt;Use are your own risk.&lt;/span&gt;`

| `user.profile.accessible`
| Whether regular users can access their own profile to change their password and other profile information. This setting has no effect when running in pre-authentication mode.
| `false`
| `true`

| `user-selection.hideUsers`
| Whether the list of users show in the users tab of the project settings is restricted. If this setting is enable, the full name of a user has to be entered into the input field before the user can be added. If this setting is disabled, it is possible to see all enabled users and to add any of them to the project.
| `false`
| `true`

| `commands.open-browser`
| Execute this command instead of the operating-systems's default command to open the browser window when running in standalone mode. `%u` is replaced with the INCEpTION URL.
| _unset_
| `/usr/bin/open %u -a "/Applications/Google Chrome.app"`

| `plugins.enabled`
| Whether to enable the ability to install plugins into {product-name} (experimental).
| `false`
| `true`

| `ui.error-page.hide-details`
| Disable display of information about operating system, Java version, etc. on the error page. While this information is useful for local users when reporting bugs, security-conscious administrators running {application-name} as a service may want to enable hiding the details to avoid information about their system being exposed.
| `false`
| `true`
|===

:leveloffset: 1

:leveloffset: +1

= Database connection

.Database settings in the `settings.properties` file
[cols="4*", options="header"]
|===
| Setting
| Description
| Default
| Example

| database.url
| JDBC connection string
| _HSQLDB location in application home_
| jdbc:mariadb://localhost:3306/inception?useUnicode=true&amp;characterEncoding=UTF-8&amp;serverTimezone=UTC

| database.username
| Database username
| sa
| user

| database.password
| Database password
| _unset_
| pass

| database.dialect
| Database dialect
| _unset (auto detected)_
| org.hibernate.dialect.MariaDB53Dialect

| database.driver
| Database driver
| _unset (auto detected)_
| org.mariadb.jdbc.Driver

| database.initial-pool-size
| Initial database connection pool size
| 4
|

| database.min-pool-size
| Minimum database connection pool size
| 4
|

| database.max-pool-size
| Maximum database connection pool size
| 10
|

| warnings.embeddedDatabase
| Warn about using an embedded database
| true
| false
|===

The basic database connection details can also be configured via environment variables. When these
environment variables are present, they are preferred over the `settings.properties` file.
The following environment variables can be used:

.Database configuration via environment variables
[cols="4*", options="header"]
|===
| Setting
| Description
| Default
| Example

| `INCEPTION_DB_URL`
| JDBC connection string
| _HSQLDB location in application home_
| jdbc:mariadb://localhost:3306/inception?useUnicode=true&amp;characterEncoding=UTF-8&amp;serverTimezone=UTC

| `INCEPTION_DB_USERNAME`
| Database username
| sa
| user

| `INCEPTION_DB_PASSWORD`
| Database password
| _unset_
| pass

| `INCEPTION_DB_DIALECT`
| Database dialect
| _unset (auto detected)_
| org.hibernate.dialect.MariaDB53Dialect

| `INCEPTION_DB_DRIVER`
| Database driver
| _unset (auto detected)_
| org.mariadb.jdbc.Driver
|===

:leveloffset: 1

:leveloffset: +1

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

= Server Settings

These settings relate to the embedded web server in the JAR version of {product-name}.

.Server settings
[cols="4*", options="header"]
|===
| Setting
| Description
| Default
| Example

| `server.port`
| Port on which the server listens
| `8080`
| `18080`

| `server.address`
| IP address on which the server listens
| `0.0.0.0`
| `127.0.0.1`

| `server.ajp.port`
| Port for AJP connector
| `-1` _(disabled)_
| `8009`

| `server.ajp.address`
| IP address on which the AJP connector listens
| `127.0.0.1`
| `0.0.0.0`

| `server.ajp.secret-required`
| Whether AJP connections require a shared secret
| `true`
| `false`

| `server.ajp.secret`
| Shared secret for AJP connections
| _unset_
| _some secret string of your choice_

| `server.startup-notice.enabled`
| Whether a self-refreshing startup screen is served while the application is booting before the login screen becomes available
| `true`
| `false`
|===

NOTE: The application is based on Spring Boot and using an embedded Tomcat server. You can configure
      additional aspects of the embedded web server using default link:https://docs.spring.io/spring-boot/docs/2.7.x/reference/html/application-properties.html[Spring Boot configuration settings].


:leveloffset: 1

:leveloffset: +1

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

[[sect_security_authentication]]
= Authentication

This section describes the different authentication mechanisms supported by {product-name}.

NOTE: A user can only log in through one mechanism, either as a local user or an external user.
      If you are using SAML/OAuth2, then the users are bound to one particular IdP. If a user with the same
      name tries to log in via another mechanism or IdP, the login will be rejected. If you plan to use
      multiple login mechanisms or IdPs at the same time, you must ensure that the user IDs are unique
      across all the mechanisms and IdPs or that a given user always uses the same login mechanism.

:leveloffset: 1
:leveloffset: +2

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

[[sect_security_authentication_oauth2]]
= OAuth2 authentication

{product-name} can authenticate a user against a OAuth2/OIDC-compatible identity provider. OAuth2/OIDC providers can be configured alongside the usual form-based login and SAML2.
It is **not** compatible with the &lt;&lt;sect_security_authentication_preauth,external pre-authentication&gt;&gt; and does not require setting the `auth.mode` property.

The following example configuration declares an OAuth2 service connection named `inception-client`
which uses a Keycloak instance configured for OAuth2 running at
`http://localhost:8180/realms/inception-demo`. The OAuth2 support of {product-name} should work with
any OAuth2/OIDC-compatible identity provider. For more details, please
refer to the link:https://docs.spring.io/spring-security/reference/servlet/oauth2/client/authorization-grants.html[Spring Security OAuth2 documentation].

.Example: Authenticate against a local Keycloak</pre>
</div>
</div>
<div class="paragraph">
<p>spring.security.oauth2.client.registration.inception-client.client-name=Keycloak
spring.security.oauth2.client.registration.inception-client.client-id=inception-client
spring.security.oauth2.client.registration.inception-client.client-secret=ENCRYPTED_CLIENT_SECRET
spring.security.oauth2.client.registration.inception-client.scope=openid, profile
spring.security.oauth2.client.registration.inception-client.authorization-grant-type=authorization_code
spring.security.oauth2.client.registration.inception-client.redirect-uri=http://localhost:8080/login/oauth2/code/inception-client
spring.security.oauth2.client.provider.inception-client.issuer-uri=http://localhost:8180/realms/inception-demo
spring.security.oauth2.client.provider.inception-client.user-name-attribute=preferred_username</p>
</div>
<div class="listingblock">
<div class="content">
<pre>NOTE: The following instructions run Keycloak in development mode. This is **not** meant for
      production, only for testing. For how to properly set up a production-level Keycloak server, please
      refer to the official documentation of Keycloak.

If you want to try this with a local testing instance of Keycloak, you can do this:

* Download link:https://www.keycloak.org[Keycloak]
* Run it using `./kc.sh start-dev --http-port 8180`
* Configure a new realm called `inception-demo`
* Define a new client `inception-client` and set the *Valid redirection URI* to `http://localhost:8080/login/oauth2/code/inception-client`.
* Replace the `ENCRYPTED_CLIENT_SECRET` in the example configuration above with the client secret from
  the *Credentials* tab of the client in Keycloak.
* Add a new user in the *Manage users* area in Keycloak.

When you restart {product-name} and access the login page now, it should offer a login option called
*Keycloak*. You can change the label of that option by changing the
`security.oauth2.client.registration.inception-client.client-name` setting.

:leveloffset: 1
:leveloffset: +2

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

[[sect_security_authentication_saml2]]
= SAML authentication

{product-name} can authenticate a user against a SAML2-compatible identity provider. SAML
providers can be configured alongside the usual form-based login and OAuth2.
It is **not** compatible with the &lt;&lt;sect_security_authentication_preauth,external pre-authentication&gt;&gt;
and does not require setting the `auth.mode` property.

The following example configuration declares a SAML2 service connection named `inception-client`
which uses a Keycloak instance configured for SAML2 running at
`http://localhost:8180/realms/inception-demo`. The SAML support of {product-name} should work with
any SAML2-compatible identity provider. For more details, please
refer to the link:https://docs.spring.io/spring-security/reference/servlet/saml2/index.html[Spring Security SAML2 documentation].

.Example: Authenticate against a local Keycloak</pre>
</div>
</div>
<div class="paragraph">
<p>spring.security.saml2.relyingparty.registration.inception-client.assertingparty.entity-id=http://localhost:8180/realms/inception-demo
spring.security.saml2.relyingparty.registration.inception-client.assertingparty.verification.credentials[0].certificate-location=file:/srv/inception/keycloak-saml-idp.crt
spring.security.saml2.relyingparty.registration.inception-client.assertingparty.singlesignon.url=http://localhost:8180/realms/inception-demo/protocol/saml
spring.security.saml2.relyingparty.registration.inception-client.assertingparty.singlesignon.sign-request=false</p>
</div>
<div class="listingblock">
<div class="content">
<pre>NOTE: The following instructions run Keycloak in development mode. This is **not** meant for
      production, only for testing. For how to properly set up a production-level Keycloak server, please
      refer to the official documentation of Keycloak.

If you want to try this with a local testing instance of Keycloak, you can do this:

* Download link:https://www.keycloak.org[Keycloak]
* Run it using `./kc.sh start-dev --http-port 8180`
* Configure a new realm called `inception-demo`
* Define a new client and in the client wizard set
** Client ID: `http://localhost:8080/saml2/service-provider-metadata/inception-client`
** Client protocol: `saml`
** Save the client
* Set *Valid redirection URI* to `http://localhost:8080/login/saml2/sso/*`.
* Set *Client signature Required* to `Off`
* Add a new user in the *Manage users* area in Keycloak.

The `keycloak-saml-idp.crt` file needs to be constructed by you. Once the configuration is complete
in Keycloak, you can access `http://localhost:8180/realms/inception-demo/protocol/saml/descriptor` to obtain
an XML file which contains the certificate in the `ds:X509Certificate` element. You need to copy this
certificate string (usually staring with `MIIC` into a text file with the following structure:

.Certificate file structure</pre>
</div>
</div>
<div class="paragraph">
<p>-----BEGIN CERTIFICATE-----
MIIC&#8230;&#8203;
-----END CERTIFICATE-----</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Save this file at the location indicated by the `....verification.credentials.certificate-location` key,
(here `/srv/inception/keycloak-saml-idp.crt`).

When you restart {product-name} and access the login page now, it should offer a login option called
*inception-client*. The SAML authentication does not allow defining the provider name shown on the login page independently from the registration ID. The registration ID (here `inception-client`) is defined in between the `registration`
and `assertingparty` parts of the configuration keys.

== Client certificate (optional)

You can provide {product-name} with a certificate so the IdP can verify that authentication requests are
really coming from it.

* First, we generate a certificate and a key file using (we are using a 2048-bit key here, but you might care
to use a longer key)
+</pre>
</div>
</div>
<div class="paragraph">
<p>openssl req -x509 -newkey rsa:2048 -keyout /srv/inception/inception.key -out /srv/inception/inception.crt -sha256 -days 365 -nodes -subj "/CN=inception-demo"</p>
</div>
<div class="listingblock">
<div class="content">
<pre>* In order to upload these, both need to be in one PEM file, so we concatenate the two files:
+</pre>
</div>
</div>
<div class="paragraph">
<p>cat /srv/inception/inception-saml.key /srv/inception/inception-saml.crt &gt; /srv/inception/inception-saml.pem</p>
</div>
<div class="listingblock">
<div class="content">
<pre>* Open the previously defined client in Keycloak (e.g. `http://localhost:8080/saml2/service-provider-metadata/inception-client`)
* Set *Client signature Required* to `Off` and save the settings
* Now a new tab *Keys* should appear at the top. Switch to it.
* Click on *Import* and select *PEM* as the format, then upload the file `/srv/inception/inception.pem`
* Enable request signing in the `settings.properties` file
+</pre>
</div>
</div>
<div class="paragraph">
<p>spring.security.saml2.relyingparty.registration.inception-client.assertingparty.singlesignon.sign-request=true</p>
</div>
<div class="listingblock">
<div class="content">
<pre>* Configure the certificates for {product-name} to sign its requests
+</pre>
</div>
</div>
<div class="paragraph">
<p>spring.security.saml2.relyingparty.registration.inception-client.signing.credentials[0].private-key-location=file:/srv/inception/inception-saml.key
spring.security.saml2.relyingparty.registration.inception-client.signing.credentials[0].certificate-location=file:/srv/inception/inception-saml.crt</p>
</div>
<div class="listingblock">
<div class="content">
<pre>:leveloffset: 1
:leveloffset: +2

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

[[sect_security_auto_authentication_login]]
= Auto-login

When configuring the application for SAML/OAuth2, the user will still be required to choose an identity
provider via the login page (and is also given the opportunity to log in via form-based login there).

If you would like to automatically login through a particular SAML identity provider, you
can configure this by setting the `security.auto-login` property to the registration ID of the
respective provider that you configured using the `spring.security.saml2.relyingparty.registration....` or `spring.security.oauth2.client...` properties.

This setting is useful for single-sign-on scenarios where only a single identity provider is used.

[cols="4*", options="header"]
|===
| Setting
| Description
| Default
| Example

| `security.login.auto-login`
| Auto-login using given identity provider
| _&lt;none&gt;_
| `inception-client` (cf. example above)

|===

NOTE: In case it may be necessary to bypass the auto-login, e.g. to allow signing in via credentials,
      navigate to `.../login.html?skipAutoLogin=true`. Make sure to do this in a fresh browser session that is
      not yet logged into the application.

:leveloffset: 1
:leveloffset: +2

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

[[sect_security_authentication_preauth]]
= External pre-authentication

{product-name} can be used in conjunction with header-based external per-authentication. In this mode,
the application looks for a special HTTP header (by default `remote_user`) and if that header exists,
it is taken for granted that this user has been authenticated. The application will check its internal
database if a user by the given name exists, otherwise it will create the user.

Pre-authentication can be enabled by setting the property `auth.mode` to `preauth`. When enabling
pre-authentication mode, the default roles for new users can be controlled using the
`auth.preauth.newuser.roles` property. The `ROLE_USER` is always added, even if not specified
explicitly. Adding also the role `ROLE_PROEJCT_CREATOR` allows all auto-created users also to
create their own projects.

Since the default administrator user is not created in pre-authentication, it is useful to also
declare at least one user as an administrator. This is done through the property
`auth.user.&lt;username&gt;.roles` where `&lt;username&gt;` must be replaced with the name of the user.
The example below shows how the user *Franz* is given administrator permissions.

In order to log out, one can specify an URL to redirect to after the session is cleared on the side
of {product-name}.

.Example: Authenticate using the `remote_user` header, new users can create projects, user *Franz* is always admin.</pre>
</div>
</div>
<div class="paragraph">
<p>auth.mode                     = preauth
auth.preauth.header.principal = remote_user
auth.preauth.newuser.roles    = ROLE_PROJECT_CREATOR
auth.user.Franz.roles         = ROLE_ADMIN</p>
</div>
<div class="listingblock">
<div class="content">
<pre>NOTE: The roles specified through `auth.preauth.newuser.roles` are saved in the database when a
      user logs in for the first time and can be changed after creation through the user interface.

NOTE: The roles added through `auth.user.&lt;username&gt;.roles` properties are *not* saved in the
      database and *cannot* be edited through the user interface.


[cols="4*", options="header"]
|===
| Setting
| Description
| Default
| Example

| `auth.mode`
| Authentication mode
| `database`
| `preauth`

| `auth.preauth.header.principal`
| Principal header
| `remote_user`
| _some other header_

| `auth.preauth.newuser.roles`
| Default roles for new users (comma separated)
| _&lt;none&gt;_
| `ROLE_PROJECT_CREATOR`

| `auth.preauth.logoutUrl`
| URL to call after logging out to also sign out of external authentication
| _&lt;none&gt;_
| `https://your-idp.com/Shibboleth.sso/Logout`

| `auth.user._&lt;username&gt;_.roles`
| Extra roles for user (comma separated)
| _&lt;none&gt;_
| `ROLE_ADMIN`

|===

:leveloffset: 1
:leveloffset: +2

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

[[sect_security_authentication_policy]]
= Policy

You have several options of configuring which types of usernames and passwords are accepted.
Note that these values are only enforced when creating new users or updating passwords. They
will not invalidate existing usernames or passwords. Length restrictions and patterns are checked
independently. If either fails, the username or password is rejected.

NOTE: When external pre-authentication is used, these settings are ignored.

NOTE: In addition to the restrictions imposed here, {product-name} may impose additional restrictions.
      E.g. certain usernames are not allowed and certain characters are also not allowed to appear in usernames.

[cols="4*", options="header"]
|===
| Setting
| Description
| Default
| Example

| `security.minimum-password-length`
| Minimum number of characters a password can have
| 8
| (max 128)

| `security.maximum-password-length`
| Maximum number of characters a password can have
| 32
| (max 128)

| `security.minimum-username-length`
| Minimum number of characters a username can have
| 4
| (max 128)

| `security.maximum-username-length`
| Maximum number of characters a username can have
| 64
| (max 128)

| `security.username-pattern`
| Regular expression for valid usernames
| `.*`
| `[a-zA-Z0-9]+`

| `security.password-pattern`
| Regular expression for valid passwords
| `.*`
| `(?=.\*[a-z])(?=.*[A-Z])(?=.\*[0-9])(?=.*\p{Punct}).*`

|===



:leveloffset: 1

:leveloffset: +1

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

= Internal annotation backup

{product-name} stores its annotations internally in files. Whenever a user
performs an action on a document, the file is updated. It is possible to configure {product-name}
to keep internal backups of these files, e.g. to safeguard against certain types of crashes or bugs.

NOTE: This internal backup is not a replacement for a proper backup. It affects only the annotation
files - not the project data, knowledge bases, or other kinds of data. Also, the annotation data is
not directly re-usable by {product-name} without additional information that is contained in the
database!

.Example internal backup
[source,text]</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_delete_annotation_backups_older_than_30_days_60_60_24_30_30_days"><a class="anchor" href="#_delete_annotation_backups_older_than_30_days_60_60_24_30_30_days"></a>Delete annotation backups older than 30 days (60 * 60 * 24 * 30 = 30 days)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>backup.keep.time=2592000</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_at_least_5_minutes_must_pass_between_two_annotation_backups_60_5_5_minutes"><a class="anchor" href="#_at_least_5_minutes_must_pass_between_two_annotation_backups_60_5_5_minutes"></a>At least 5 minutes must pass between two annotation backups (60 * 5 = 5 minutes)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>backup.interval=300</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_keep_at_most_10_backups_for_each_annotation_backup"><a class="anchor" href="#_keep_at_most_10_backups_for_each_annotation_backup"></a>Keep at most 10 backups for each annotation backup</h2>
<div class="sectionbody">
<div class="paragraph">
<p>backup.keep.number=10</p>
</div>
<div class="listingblock">
<div class="content">
<pre>The internal backups are controlled through three properties:

.Database settings in the `settings.properties` file
[cols="4*", options="header"]
|===
| Setting
| Description
| Default
| Example

| `backup.interval`
| Time between backups (seconds)
| `172800` _(60 * 60 * 24 = 24 hours)_
| `0` _(disabled)_

| `backup.keep.number`
| Maximum number of backups to keep
| `2`
| `0` _(unlimited)_

| `backup.keep.time`
| Maximum age of backups to keep (seconds)
| `0` _(unlimited)_
| `2592000` _(60 * 60 * 24 * 30 = 30 days)_
|===

The interval controls the minimum time between changes to a document that needs to have elapsed in
order for a new backup to be created. Setting the interval to `0` disables the internal backups.

When backups are enabled, either or both of the properties **backup.keep.number** and
**backup.keep.time** should be changed as well, because their default values will cause the
backups to be stored indefinitely and they will eventually fill up the disk.

The properties **backup.keep.number** and **backup.keep.time** control how long backups are keep
and the maximal number of backups to keep. These settings are effective simultaneously.

.Example: Make backups every 5 minutes and keep 10 backups irrespective of age</pre>
</div>
</div>
<div class="paragraph">
<p>backup.interval    = 300
backup.keep.number = 10
backup.keep.time   = 0</p>
</div>
<div class="listingblock">
<div class="content">
<pre>.Example: Make backups every 5 minutes and all not older than 7 days (60 * 60 * 24 * 7 seconds)</pre>
</div>
</div>
<div class="paragraph">
<p>backup.interval    = 300
backup.keep.number = 0
backup.keep.time   = 604800</p>
</div>
<div class="listingblock">
<div class="content">
<pre>.Example: Make backups every 5 minutes and keep at most 10 backups that are not older than 7 days</pre>
</div>
</div>
<div class="paragraph">
<p>backup.interval    = 300
backup.keep.number = 10
backup.keep.time   = 604800</p>
</div>
<div class="listingblock">
<div class="content">
<pre>:leveloffset: 1

:leveloffset: +1

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

= CAS storage

This section describes settings related to the storage of CAS data objects (i.e. annotations).

.CAS cache settings in the `settings.properties` file
[cols="4*", options="header"]
|===
| Setting
| Description
| Default
| Example

| `cas-storage.compressed-cas-serialization`
| Whether to compress annotation files
| `true`
| `false`

| `cas-storage.file-system-timestamp-accuracy`
| For file systems where timestamps are not exact, this can be used to configure some leniency. This setting should be used with extreme caution. If an editor accesses an annotation file that is out-of-sync with the editor, this can lead to unexpected behavior. However, when deploying {product-name} e.g. on certain cloud storage facilitites, the file system timestamps may not be exact down to the millisecond,
this it may be helpful to configure a slight leniency here.
| `0`
| `500ms`
|===

The compression setting takes effect whenever a CAS is written to disk. Changing it does not
immediately (de)compress existing CAS files. Instead, they will be slowly converted to being
(de)compressed over time as they are updated by the system as part of normal operations.

== CAS cache

To speed up interactions, {product-name} keeps a cache annotation data in memory.
This cache can be tuned using the following properties:

.CAS cache settings in the `settings.properties` file
[cols="4*", options="header"]
|===
| Setting
| Description
| Default
| Example

| `cas-storage.cache.shared-cas-cache-size`
| Number of shared read-only CASes to keep in memory
| `10`-`5000` _(depending on heap size)_
| `20000`

| `cas-storage.cache.idle-cas-eviction-delay`
| Periodic interval in which the system should check if CASes can be removed from the memory cache
| `5m`
| `30s`

| `cas-storage.cache.min-idle-cas-time`
| Time a CAS should at least remain cached in memory to avoid loading from disk
| `5m`
| `30s`

| `cas-storage.cache.cas-borrow-wait-timeout`
| Time for an exclusive action to wait for another exclusive action to finish
| `3m`
| `5m`
|===

:leveloffset: 1

:leveloffset: +1

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

= Document Im-/Export

Control the importing and exporting of documents:

.Document import/export settings in the `settings.properties` file
[cols="4*", options="header"]
|===
| Setting
| Description
| Default
| Example

| document-import.max-tokens
| Token-count limit for imported documents
| 2000000
| 0 _(no limit)_

| document-import.max-sentences
| Sentence-count limit for imported documents
| 20000
| 0 _(no limit)_
|===


:leveloffset: 1

:leveloffset: +1

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

= Custom header icons

{product-name} allows adding custom icons to the page header. You can declare such custom icons in the  `settings.properties` file as shown in the example below. Each declaration begins with the prefix `style.header.icon.` followed by an identifier (here `myOrganization` and `mySupport`). The suffixes `.linkUrl` and `.imageUrl` indicate the URL of the target page and of the icon image respectively. Images are automatically resized via CSS. However, to keep loading times low, you should point to a reasonably small image.

The order of the icons is controlled by the ID, not by the order in the configuration file!

.Example: Custom header icon</pre>
</div>
</div>
<div class="paragraph">
<p>style.header.icon.myOrganization.linkUrl=http://my.org
style.header.icon.myOrganization.imageUrl=http://my.org/logo.png
style.header.icon.mySupport.linkUrl=http://my.org/support
style.header.icon.mySupport.imageUrl=http://my.org/help.png</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[cols="4*", options="header"]
|===
| Setting
| Description
| Default
| Example

| style.header.icon...
| Icons/links to display in the page header. For details, see below.
| _unset_
|
|===

:leveloffset: 1

:leveloffset: +1

= Project dashboard

.Project dashboard settings in the `settings.properties` file
[cols="4*", options="header"]
|===
| Setting
| Description
| Default
| Example

| `ui.dashboard.accessible-by-roles`
| System roles able to access project dashboards
| `ANNOTATOR`, `CURATOR`, `MANAGER`
| `MANAGER`
|===

NOTE: To specify multiple values of the `ui.dashboard.accessible-by-roles` in a `settings.properties`
      file, multiple lines need to be added like `ui.dashboard.accessible-by-roles[0]=ANNOTATOR`,
      `ui.dashboard.accessible-by-roles[1]=CURATOR`, etc.

NOTE: Project managers can always access the project dashboard, even if they are not included in the
      `ui.dashboard.accessible-by-roles` setting.

:leveloffset: 1

:leveloffset: +1

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

= Theming

There are two options of theming {product-name}.

The recommended approach is placing a file named `theme.css` into the application home folder. If
this file is present, it is automatically loaded on all pages of the application. You can place
custom styles into the file and make them override the default styles.

There is also the option to place a file called `bootstrap.css` into the application folder. If that
file is present, the built-in customized Bootstrap styles of {product-name} are not loaded and this
file is loaded instead. For the application to work, the custom `bootstrap.css` must be fully
compatible with the built-in styles. To create such a file, obtain the `scss` files from the
link:https://github.com/inception-project/inception/tree/main/inception/inception-bootstrap/src/main/ts/bootstrap[inception-bootstrap] module for the {product-name} version that you are using, adjust
them, and use SCSS to compile them from the root `bootstrap.scss` file into a customized
`bootstrap.css` file.

NOTE: New versions of {product-name} may come with changes to the CSS styles being used without
      any special announcement. If you use theming, be sure to thoroughly review if your custom styles still
      work with new versions. Best keep any changes minimal.

.Theming settings
[cols="4*", options="header"]
|===
| Setting
| Description
| Default
| Example

| `ui.dark-mode.enabled`
| Whether to enable the ability switch between light and dark mode (experimental).
| `false`
| `true`
|===

:leveloffset: 1

:leveloffset: +1

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

[[sect_settings_annotation]]
= Annotation editor

.Settings related to the brat editor
[cols="4*", options="header"]
|===
| Setting
| Description
| Default
| Example

| annotation.default-preferences.auto-scroll
| Whether to scroll the annotation being edited into the center of the page
| true
|

| annotation.default-preferences.page-size
| The number of sentences to display per page
| 5
|

| ui.brat.single-click-selection
| Whether to select annotations with a single click
| false
|
|===

.Settings related to string features
[cols="4*", options="header"]
|===
| Setting
| Description
| Default
| Example

| annotation.feature-support.string.combo-box-threshold
| If the tagset is larger than the threshold, an combo-box field is used instead of a radio-choice.
| 6
| 16

| annotation.feature-support.string.auto-complete-threshold
| If the tagset is larger than the threshold, an auto-complete field is used instead of a standard combobox.
| 75
| 100

| annotation.feature-support.string.auto-complete-max-results
| When an auto-complete field is used, this determines the maximum number of items shown in the dropdown menu.
| 100
| 1000
|===

.Settings related to link features
[cols="4*", options="header"]
|===
| Setting
| Description
| Default
| Example

| annotation.feature-support.link.auto-complete-threshold
| If the tagset is larger than the threshold, an auto-complete field is used instead of a standard combobox.
| 75
| 100

| annotation.feature-support.link.auto-complete-max-results
| When an auto-complete field is used, this determines the maximum number of items shown in the dropdown menu.
| 100
| 1000
|===


:leveloffset: 1
:leveloffset: +2

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

[[sect_settings_annotation-editor_pdf]]
= PDF Editor Settings

This section describes the global settings related to the PDF annotation editor module.

.Knowledge base settings overview
[cols="4*", options="header"]
|===
| Setting
| Description
| Default
| Example

| `ui.pdf.enabled`
| enable/disable KB support
| `true`
| `false`
|===

:leveloffset: 1
:leveloffset: +2

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

[[sect_settings_annotation-editor_pdf_legacy]]
= PDF Editor Settings (legacy)

====
CAUTION: Legacy feature. To use this functionality, you need to enable it first by adding `ui.pdf-legacy.enabled=true` to the `settings.properties` file.

Support for this feature will be removed in a future version. The replacement is &lt;&lt;sect_settings_annotation-editor_pdf&gt;&gt;.
====

This section describes the global settings related to the legacy PDF annotation editor module.

.Knowledge base settings overview
[cols="4*", options="header"]
|===
| Setting
| Description
| Default
| Example

| `ui.pdf-legacy.enabled`
| enable/disable KB support
| `false`
| `true`
|===

:leveloffset: 1
:leveloffset: +2

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

[[sect_settings_segmentation]]
= Editable Segmentation Settings

====
CAUTION: Experimental feature. Highly experimental. Expect strange things to happen if you start
adding/removing/changing segmentation annotations (i.e. sentences or tokens).
====

This section describes the global settings related to the support for editable segmentation annotations (i.e. sentences or tokens).

.Knowledge base settings overview
[cols="4*", options="header"]
|===
| Setting
| Description
| Default
| Example


| ui.sentence-layer-editable=true
| Enable/disable editing sentences
| false
| true
|===

:leveloffset: 1

:leveloffset: +1

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

[[sect_settings_documentmetadata]]
= Document Metadata Settings

This section describes the global settings related to the document metadata annotation support.

NOTE: Disabling document metadata support prevents new document metadata layers from being
       created, but it does not prevent the use of existing document metadata layers layers in order
       not to break existing projects.

.Knowledge base settings overview
[cols="4*", options="header"]
|===
| Setting
| Description
| Default
| Example


| documentmetadata.enabled
| Enable/disable search
| false
| true
|===

:leveloffset: 1

:leveloffset: +1

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

[[sect_settings_concept-linking]]
= Concept Linking

There are several configurable parameters related to the Concept Linking functionality:

.Cache size
This parameter controls the size of the Candidate Cache, which stores a set of candidates for a mention.
Increasing the cache size will reduce the number of queries that have to be made against the KB
and therefore increase average retrieval time.

.Candidate Frequency Threshold
This parameter controls after how many concepts the ranking approach should take into account by
selecting the `n` most frequent concepts. Increasing this parameter will lead to a longer ranking time,
since more candidates are considered for ranking.

.Mention Context Size
This parameter declares the size `k` of the context, where the context is defined as the words
included in a window with `k` words to both left and right.

.Candidate Retrieval Limit
This parameter defines how many concepts should be retrieved for the Candidate Retrieval step.
Increasing this parameter will lead to a longer time to retrieve candidates from the KB.

.Semantic Signature Query Limit
This parameter defines how many concepts should be retrieved for the Semantic Signature of a candidate.
Increasing this parameter will lead to a longer time to retrieve concepts for constructing the Semantic Signature.

.Candidate Display Limit
This parameter regulates how many candidates will be displayed for a mention in the Concept Selector UI.

If no value for a parameter is specified, its default value is used. The default values are shown as
examples of how the parameters can be configured below:

.Concept linking settings overview
[cols="4*", options="header"]
|===
| Setting
| Description
| Default
| Example

| inception.entity-linking.cacheSize
| Cache size
| 1024
| -

| inception.entity-linking.candidateQueryLimit
| Candidate Retrieval Limit
| 2500
| -

| inception.entity-linking.mentionContextSize
| Mention Context Size
| 5
| -

| inception.entity-linking.candidateDisplayLimit
| Candidate Display Limit
| 100
| -

| inception.entity-linking.signatureQueryLimit
| Semantic Signature Query Limit
| 2147483647
| -
|===

== Resources

In order to improve the quality of suggestions, several additional resources can be incorporated.
These are to be put into the `.inception/resources` folder. These include:

* properties_with_labels.txt
- List of properties, each line containing information for one property, tab-separated
|===
| ID | Label | Description | Aliases | Data type | Count
|P6
|head of government
|head of the executive power of this town, city, municipality, state,
 country, or other governmental body
|government headed by, executive power headed by, president, chancellor
|wikibase-item
|17,592
|===

* property_blacklist.txt
- A list of properties that are filtered when computing the Semantic Signature, one property ID per line,
e.g. `P1005`, `P1014`


* stopwords-en.txt
- A list of stopwords, one stopword per line, e.g. `i`, `me`

* wikidata_entity_freqs.map
- Each line consists of a the ID of a concept and its frequency in the KB, tab-separated,
e.g. `Q4664130  409104, Q30 205747`


:leveloffset: 1

:leveloffset: +1

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

[[sect_settings_knowledge-base]]
= Knowledge Base Settings

This section describes the global settings related to the knowledge base module.

.Default max results
This parameter determines the default value for the maximum number of results that can be retrieved from a SPARQL query.
The queries are used to retrieve concepts, statements, properties, etc. from the knowledge base.
The maximum number of results can also be configured separately for each knowledge base in the project settings.

.Hard max results
A hard limit for the *Max results* parameter.

If no value for the parameter is specified, its default value is used. The default value is shown as
an example of how the parameter can be configured below:

.Knowledge base settings overview
[cols="4*", options="header"]
|===
| Setting
| Description
| Default
| Example

| knowledge-base.enabled
| enable/disable KB support
| true
| false

| knowledge-base.default-max-results
| default result limit for SPARQL query
| 1000
| 10000

| knowledge-base.hard-max-results
| hard limit for the maximum number of results from a query
| 10000
| 5000

| knowledge-base.cache-size
| number of items (classes, instances and properties) to cache
| 100000
| 500000

| knowledge-base.cache-expire-delay
| time before items are expunged from the cache
| 15m
| 1h

| knowledge-base.cache-refresh-delay
| time before items are asynchronously refreshed
| 5m
| 30m

| knowledge-base.render-cache-size
| number of items (classes, instances and properties) to cache during rendering
| 10000
| 50000

| knowledge-base.render-cache-expire-delay
| time before items are expunged from the render cache
| 10m
| 1h

| knowledge-base.render-cache-refresh-delay
| time before items are asynchronously refreshed when rendering
| 1m
| 5m

| knowledge-base.remove-orphans-on-start
| whether to delete orphaned KBs on start
| false
| true
|===

NOTE: Disabling the knowledge base support will lead to the loss of concept linked features from
      documents/projects that were using them. If you wish to run the application without knowledge base
      support, it is strongly recommended to disable the feature immediately after the installation and
      not after any projects have potentially started using it.

:leveloffset: 1

:leveloffset: +1

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

[[sect_settings_scheduler]]
= Scheduler Settings

This section describes the global settings related to the scheduler.

.Number of threads
This parameter determines the number of threads the scheduler uses. It should be less than hardware
threads available on the machine that runs INCEpTION. The higher the number, the more tasks can be
run in parallel.

.Queue size
This parameter determines the maximum number of tasks that can be waiting in the scheduler queue. If
the queue is full, then no new tasks can be scheduled until running tasks are completed.

If no value for the parameter is specified, its default value is used. The default value is shown as
an example of how the parameter can be configured below:

.Scheduler settings overview
[cols="4*", options="header"]
|===
| Setting
| Description
| Default
| Example

| inception.scheduler.numberOfThreads
| Number of threads that run tasks
| 4
| 8

| inception.scheduler.queueSize
| Maximum number of tasks waiting for execution
| 100
| 200
|===

:leveloffset: 1

:leveloffset: +1

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

[[sect_settings_search]]
= Document Repositories Settings

This section describes the global settings related to the external document repository support.

.Document repository settings overview
[cols="4*", options="header"]
|===
| Setting
| Description
| Default
| Example


| external-search.enable
| Enable/disable document repository support
| true
| false
|===

:leveloffset: 1

:leveloffset: +1

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

[[sect_settings_recommender]]
= Recommender Settings

This section describes the global settings related to the recommender module.

.Recommender settings overview
[cols="4*", options="header"]
|===
| Setting
| Description
| Default
| Example

| `recommender.enabled`
| enable/disable recommender support
| `true`
| `false`

| `recommender.evaluation-page.enabled`
| enable/disable evaluation page
| `true`
| `false`

| `recommender.sidebar.enabled`
| enable/disable recommender sidebar on annotation page
| `true`
| `false`
|===

:leveloffset: 1
:leveloffset: +2

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

[[sect_settings_String_relation_recommender]]
= String Matching Recommender for Relations Settings

You can enable the String recommender for relations in your {product-name} instance.

.String Matching Relation Recommnder Settings
[cols="4*",options="header"]
|===
| Setting
| Description
| Default
| Example

| recommender.string-matching.relation
| enable/disable String relation recommender
| false
| true
|===


:leveloffset: 1
:leveloffset: +2

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

[[sect_settings_recommender_external]]
= External Recommender Settings

.External recommender settings
[cols="4*", options="header"]
|===
| Setting
| Description
| Default
| Example

| recommender.external.enabled
| enable/disable external recommender support
| true
| false

| recommender.external.connect-timeout
| duration of connect timeout
| 30s
| 3m

| recommender.external.read-timeout
| duration of read timeout
| 30s
| 3m
|===


:leveloffset: 1

:leveloffset: +1

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

[[sect_settings_sharing]]
= Invite Links Settings

====
CAUTION: Experimental feature.
====

You can enable invite links for your {product-name} instance. This will allow project managers to
generate invite links for their project which will expire automatically after one year or at a
chosen date. They can also be deleted or regenerated by the manager. Any user of your instance can
use this invite link to access the project. She will automatically be added to the project with
annotator rights when following it.

Optionally, users can be invited using a password-less login. In this mode, the user logging in
simply chooses a login name and a project-bound password-less account for this user is created.
The user can only login to this account via the invite link. When the project is deleted, all the
project-bound accounts are deleted as well. The project-bound accounts internally use a randomized
user ID which allows projects projects with such accounts to be exported and imported into other
instances.

.Invite Links settings
[cols="4*", options="header"]
|===
| Setting
| Description
| Default
| Example

| sharing.invites.enabled
| enable/disable invite links
| false
| true

| sharing.invites.guests-enabled
| enable/disable guest annotators
| false
| true

| sharing.invites.invite-base-url
| base URL used to generate invite links, e.g. when running behind a reverse proxy
| _unset_
| https://public.mydomain.com/inception
|===


:leveloffset: 1

:leveloffset: +1

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

[[sect_settings_versioning]]
= Versioning Settings

====
CAUTION: Experimental feature.
====

You can enable versioning for projects in your {product-name} instance.
Project managers can create snapshots of all documents in the project as well as its layer configuration via the versioning panel.
This is done via a git repository stored in the `+.inception+` folder.
This git repository can also be used to push to a remote repository, e.g. saving on Github or Gitlab.

.Versioning settings
[cols="4*",options="header"]
|===
| Setting
| Description
| Default
| Example

| versioning.enabled
| enable/disable versioning
| false
| true
|===


:leveloffset: 1

:leveloffset: +1

// Licensed to the Technische Universitt Darmstadt under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The Technische Universitt Darmstadt
// licenses this file to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

[[sect_settings_websocket]]
= Websocket Settings

====
CAUTION: Experimental feature.
====

You can enable websocket support for your instance which allows to push messages to the client browser. This can e.g. be information for Admin users on recently logged events.

.Websocket settings
[cols="4*", options="header"]
|===
| Setting
| Description
| Default
| Example

| websocket.enabled
| enable/disable websocket support/endpoint
| false
| true

| websocket.logged-events.enabled
| enable/disable push messages for logged events
| false
| true

| websocket.recommender-events.enabled
| enable/disable push messages for recommender events
| true
| false
|===

:leveloffset: 1</pre>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 30.0<br>
Last updated 2023-12-05 17:31:22 +0100
</div>
</div>
</body>
</html>